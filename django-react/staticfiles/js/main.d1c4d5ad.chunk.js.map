{"version":3,"sources":["components/Enums.ts","components/notification/Notification.js","components/nav/Nav.js","components/auth/LoginForm.js","components/auth/SignupForm.js","components/person/MilestoneModal.js","components/relationship/RelationshipModal.js","components/person/PersonEditTimelineModal.js","components/person/Person.js","components/relationship/Relationship.js","components/person/PersonAddModal.js","components/auth/FirstTimeModal.js","components/ConfirmationModal.js","Familytree.js","App.js","serviceWorker.js","index.js"],"names":["NOTIFY","ShowNotification","notifyEnum","theme","CHANGE_THEME","toast","className","bodyClassName","progressClassName","CHANGE_COLOR","SUCCESS_LOGIN","SUCCESS_REGISTER","SUCCESS_LOGOUT","ERROR","ERROR_LOGIN","ERROR_REGISTER","ERROR_TIMEOUT","RESET","SNEAKY_PASSWORD","SAVE_PERSON","SAVE_RELATIONSHIP","SAVE_COORDS","SAVE_MILESTONE","SAVING","ADD_PERSON","ADD_RELATIONSHIP","ADD_MILESTONE","Usuń","DELETE_PERSON","DELETE_RELATIONSHIP","DELETE_MILESTONE","Nav","props","useState","dropdownOpen","setOpen","colors_dark","colors_light","getColors","color","colorIndex","colorHover","secondColor","secondColorHover","findIndex","clr","length","changeColor","map","item","localStorage","setItem","previewColor","undefined","getItem","document","documentElement","style","setProperty","color_picker","ButtonDropdown","isOpen","toggle","DropdownToggle","DropdownMenu","onMouseLeave","DropdownItem","key","hidden","backgroundColor","onClick","onMouseEnter","logged_out_nav","changeThemeMode","display_form","logged_in_nav","username","handle_logout","id","href","logged_in","LoginForm","state","password","handle_change","e","name","target","value","setState","prevstate","newState","this","method","onSubmit","handle_login","type","placeholder","toLowerCase","onChange","required","autoFocus","data-testid","React","Component","SignupForm","trim","password_number","test","password_uppercase","password_lowercase","password_nonalpha","password_length","errors","validate","isEnabled","Object","keys","some","x","handle_signup","disabled","CustomModal","handleChange","activeItem","handleChangeDate","date","dt","moment","format","RangeError","handleChangeFile","file","fileMessage","handleChangeSelect","selected","filter","el","personSelectOptions","options","axios","get","headers","Authorization","then","res","Array","from","data","push","label","first_name","last_name","catch","err","console","log","form","file_extension_invalid","image","file_ext_check","ext","substring","lastIndexOf","person_id","TypeError","title","title_too_long","text","toString","isValid","file_extension","onSave","ModalHeader","ModalBody","Form","FormGroup","Label","for","Input","peekNextMonth","showMonthDropdown","showYearDropdown","dropdownMode","onSelectedChanged","onDrop","acceptedFiles","onFileDialogCancel","multiple","getRootProps","getInputProps","ModalFooter","Button","refreshPersonList","personList","handleChangeDescendant","indexOf","handleBlur","field","evt","touched","handleChangeBeginDate","handleChangeEndDate","begin_date","end_date","genColor","idPerson","targetPerson","find","require","randomColor","hexString","description","end_date_earlier_than_begin","onBlur","getPerson","id_2","id_1","CustomInput","relationships","getRelativePath","mediaFile","CustomHeader","event","extras","Date","toISOString","slice","CustomImageBody","imageUrl","ReactPlayer","canPlay","url","controls","width","height","src","alt","CustomTextBody","relationship","together_with","join","downloadTimelineData","createMilestone","activeMilestone","user_id","ModalMilestone","editMilestone","editRelationship","activeRelationship","ModalRelationship","handleSubmitMilestone","SHA256","newFilename","oldItem","i","toggleMilestoneModal","now","FormData","append","patch","post","handleSubmitRelationship","toggleRelationshipModal","put","refreshRelationships","handleDeleteMilestone","toggleConfirmModal","Usuń","handleDeleteRelationship","handleChangeMode","checked","deleteMode","timelineData","params","dateStr","split","togetherWithNames","includes","person","parseInt","buttonText","avatar","first_name_too_long","last_name_too_long","birth_place","Fragment","size","Row","Col","md","sex_choices","status_choices","birth_date","display","marginRight","float","events","customComponents","header","imageBody","textBody","Person","toggleEditPersonModal","modal","handleSubmit","relationship_choices","refresh","handleDelete","handleClick","dragging","getCoordinates","renderRelationships","dragHandlers","onStart","onStop","grid","Anuluj","defaultPosition","y","activePersons","onDoubleClick","setActivePerson","onMouseDown","bind","onMouseUp","onMouseMove","handleMovement","draggable","printable","Relationship","relationshipMarker","personSize","renderRelationship","first","second","nav","getElementById","getBoundingClientRect","x1Temp","y1Temp","x2Temp","y2Temp","relationshipPoints","top","screen","right","bottom","left","mid","horizontalTemp","x1","y1","x2","y2","horizontal","relationshipPairList","personCoordinates","sideCoords","calcSideCenters","pointsTemp","Math","round","id1","id2","points","descendant","reference","createRef","orient","markerWidth","markerHeight","refX","refY","d","fill","stroke","ref","markerEnd","strokeWidth","triggerRef","calcTextWidth","rx","ry","fontSize","font","context","canvas","createElement","getContext","measureText","content","confirmText","cancelText","onConfirm","Familytree","refreshRelationshipList","relationshipList","toggleFirstTimeModal","ModalFirstTime","activeConfirmData","ModalConfirm","togglePersonModal","activeRelationshipData","activePersonIDList","handleSubmitPerson","Accept","createPerson","activePersonData","renderItems","coordinates","pairs","exists","downloadPDF","css","head","getElementsByTagName","media","styleSheet","cssText","appendChild","createTextNode","window","print","windowSize","saving","updateWindowDimensions","checkNewUserStatus","addEventListener","removeEventListener","registerDate","winSize","innerWidth","innerHeight","personHTML","personParentCoords","parentElement","transform","personParentX","parseFloat","personParentY","personTransformCoords","personTransformX","personTransformY","parent","personListCoords","personListHTML","querySelectorAll","personCoords","classList","pop","getCSSTransformValues","index","isNaN","offsetLeft","offsetTop","oldPersonParent","needToMove","personClassCoordinates","saved","coords","formData","setTimeout","array","splice","saveCoords","resetCoords","deleteEverything","defaultOptionsLoading","loop","autoplay","animationData","stillLoadingData","rendererSettings","preserveAspectRatio","defaultOptionsLoaded","doneLoadingData","App","loginCounter","fetchPersonList","loadingPersonList","donePersonList","fetchRelationshipList","loadingRelationshipList","doneRelationshipList","preventDefault","token","user","date_joined","displayed_form","removeItem","newTheme","body","remove","add","position","POSITION","TOP_LEFT","Boolean","location","hostname","match","ReactDOM","render","navigator","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.d1c4d5ad.chunk.js","sourcesContent":["// File which contains enum types\r\n\r\nexport enum NOTIFY {\r\n    CHANGE_THEME,\r\n    CHANGE_COLOR,\r\n\r\n    SUCCESS_LOGIN,\r\n    SUCCESS_REGISTER,\r\n    SUCCESS_LOGOUT,\r\n\r\n    ERROR,\r\n    ERROR_LOGIN,\r\n    ERROR_REGISTER,\r\n    ERROR_TIMEOUT,\r\n\r\n    RESET,\r\n\r\n    SNEAKY_PASSWORD, // deleting 'disabled' from HTML Submit Button w/ insufficient password\r\n\r\n    SAVE_PERSON,\r\n    SAVE_RELATIONSHIP,\r\n    SAVE_COORDS,\r\n    SAVE_MILESTONE,\r\n    SAVING,\r\n\r\n    ADD_PERSON,\r\n    ADD_RELATIONSHIP,\r\n    ADD_MILESTONE,\r\n\r\n    DELETE,\r\n    DELETE_PERSON,\r\n    DELETE_RELATIONSHIP,\r\n    DELETE_MILESTONE,\r\n}\r\n\r\nexport default NOTIFY;","// frontend/src/components/Notification.js\r\n\r\n    import {toast} from 'react-toastify';\r\n    import {NOTIFY} from '../Enums.ts';\r\n    import 'react-toastify/dist/ReactToastify.css';\r\n    import './Notification.css'\r\n\r\n    // function which shows specific notification, depending on given NOTIFY enum\r\n     function ShowNotification(notifyEnum, theme) {\r\n        switch(notifyEnum){\r\n          case NOTIFY.CHANGE_THEME:\r\n            toast(\"Theme has been changed and saved.\", {\r\n                className: 'custom-toast info ' + theme,\r\n                bodyClassName: 'body',\r\n                progressClassName: 'progress',\r\n            });\r\n            break;\r\n          case NOTIFY.CHANGE_COLOR:\r\n            toast(\"Color has been changed and saved.\", {\r\n                className: 'custom-toast info ' + theme,\r\n                bodyClassName: 'body',\r\n                progressClassName: 'progress',\r\n            });\r\n            break;\r\n\r\n          case NOTIFY.SUCCESS_LOGIN:\r\n            toast(\"You logged in. Have a nice use!\", {\r\n                className: 'custom-toast success ' + theme,\r\n                bodyClassName: 'body',\r\n                progressClassName: 'progress',\r\n            });\r\n            break;\r\n          case NOTIFY.SUCCESS_REGISTER:\r\n            toast(\"You registered a new account and will be redirected to login page. Log in to use this website!\", {\r\n                className: 'custom-toast success ' + theme,\r\n                bodyClassName: 'body',\r\n                progressClassName: 'progress',\r\n            });\r\n            break;\r\n          case NOTIFY.SUCCESS_LOGOUT:\r\n            toast(\"You logged out, have a nice day!\", {\r\n                className: 'custom-toast success ' + theme,\r\n                bodyClassName: 'body',\r\n                progressClassName: 'progress',\r\n            });\r\n            break;\r\n\r\n          case NOTIFY.ERROR:\r\n              toast(\"Something went wrong! Refresh page or try again later! If it doesn't help, contact administrator.\", {\r\n                className: 'custom-toast error ' + theme,\r\n                bodyClassName: 'body',\r\n                progressClassName: 'progress',\r\n            });\r\n              break;\r\n          case NOTIFY.ERROR_LOGIN:\r\n              toast(\"Incorrect username and/or password!\", {\r\n                className: 'custom-toast error ' + theme,\r\n                bodyClassName: 'body',\r\n                progressClassName: 'progress',\r\n            });\r\n              break;\r\n          case NOTIFY.ERROR_REGISTER:\r\n              toast(\"This username is already taken!\", {\r\n                className: 'custom-toast error ' + theme,\r\n                bodyClassName: 'body',\r\n                progressClassName: 'progress',\r\n            });\r\n              break;\r\n          case NOTIFY.ERROR_TIMEOUT:\r\n              toast(\"Your session has expired. Please, log in!\", {\r\n                className: 'custom-toast error ' + theme,\r\n                bodyClassName: 'body',\r\n                progressClassName: 'progress',\r\n            });\r\n              break;\r\n\r\n          case NOTIFY.RESET:\r\n              toast(\"The position of all persons has been set to the initial values!\", {\r\n                className: 'custom-toast info ' + theme,\r\n                bodyClassName: 'body',\r\n                progressClassName: 'progress',\r\n            });\r\n              break;\r\n\r\n            case NOTIFY.SNEAKY_PASSWORD:\r\n              toast(\"Don't you try to fool us by deleting 'disabled' attribute from Submit button! You wanted to outsmart us, we outsmarted you!\", {\r\n                className: 'custom-toast error ' + theme,\r\n                bodyClassName: 'body',\r\n                progressClassName: 'progress',\r\n            });\r\n              break;\r\n\r\n          case NOTIFY.SAVE_PERSON:\r\n              toast(\"New data of the person has been saved!\", {\r\n                className: 'custom-toast success ' + theme,\r\n                bodyClassName: 'body',\r\n                progressClassName: 'progress',\r\n            });\r\n              break;\r\n          case NOTIFY.SAVE_RELATIONSHIP:\r\n              toast(\"New data of the relationship has been saved!\", {\r\n                className: 'custom-toast success ' + theme,\r\n                bodyClassName: 'body',\r\n                progressClassName: 'progress',\r\n            });\r\n              break;\r\n          case NOTIFY.SAVE_COORDS:\r\n              toast(\"New coords have been saved!\", {\r\n                className: 'custom-toast success ' + theme,\r\n                bodyClassName: 'body',\r\n                progressClassName: 'progress',\r\n            });\r\n              break;\r\n          case NOTIFY.SAVE_MILESTONE:\r\n              toast(\"New milestone have been saved!\", {\r\n                className: 'custom-toast success ' + theme,\r\n                bodyClassName: 'body',\r\n                progressClassName: 'progress',\r\n            });\r\n              break;\r\n          case NOTIFY.SAVING:\r\n              toast(\"Saving coordinates... Do not leave the page until the saving process is finished!\", {\r\n                className: 'custom-toast info ' + theme,\r\n                bodyClassName: 'body',\r\n                progressClassName: 'progress',\r\n            });\r\n              break;\r\n\r\n          case NOTIFY.ADD_PERSON:\r\n              toast(\"New person has been added, it should be at the top-left corner of the page!\", {\r\n                className: 'custom-toast success ' + theme,\r\n                bodyClassName: 'body',\r\n                progressClassName: 'progress',\r\n            });\r\n              break;\r\n          case NOTIFY.ADD_RELATIONSHIP:\r\n              toast(\"New relationship has been added, it should be visible. If not, try to move something around!\", {\r\n                className: 'custom-toast success ' + theme,\r\n                bodyClassName: 'body',\r\n                progressClassName: 'progress',\r\n            });\r\n              break;\r\n          case NOTIFY.ADD_MILESTONE:\r\n              toast(\"New milestone has been added, it should be visible. If not, try to reopen Edit Person modal!\", {\r\n                className: 'custom-toast success ' + theme,\r\n                bodyClassName: 'body',\r\n                progressClassName: 'progress',\r\n            });\r\n              break;\r\n\r\n          case NOTIFY.DELETE:\r\n              toast(\"Everything has been deleted! Now you can start from scratch.\", {\r\n                className: 'custom-toast warn ' + theme,\r\n                bodyClassName: 'body',\r\n                progressClassName: 'progress',\r\n            });\r\n              break;\r\n          case NOTIFY.DELETE_PERSON:\r\n              toast(\"Person has been deleted!\", {\r\n                className: 'custom-toast warn ' + theme,\r\n                bodyClassName: 'body',\r\n                progressClassName: 'progress',\r\n            });\r\n              break;\r\n          case NOTIFY.DELETE_RELATIONSHIP:\r\n              toast(\"Relationship has been deleted!\", {\r\n                className: 'custom-toast warn ' + theme,\r\n                bodyClassName: 'body',\r\n                progressClassName: 'progress',\r\n            });\r\n              break;\r\n          case NOTIFY.DELETE_MILESTONE:\r\n              toast(\"Milestone has been deleted!\", {\r\n                className: 'custom-toast warn ' + theme,\r\n                bodyClassName: 'body',\r\n                progressClassName: 'progress',\r\n            });\r\n              break;\r\n          default:\r\n            toast(\"Why is it empty? Contact administrator, please.\", {\r\n                className: 'custom-toast error ' + theme,\r\n                bodyClassName: 'body',\r\n                progressClassName: 'progress',\r\n            });\r\n            break;\r\n        }\r\n      }\r\n\r\n      export default ShowNotification;","/*eslint jsx-a11y/anchor-is-valid: 0*/\r\n/*eslint array-callback-return: 0*/\r\n\r\nimport React, {useState} from 'react';\r\nimport './Nav.css'\r\nimport { ButtonDropdown, DropdownToggle, DropdownMenu, DropdownItem } from 'reactstrap';\r\nimport { NOTIFY } from '../Enums.ts'\r\nimport ShowNotification from '../notification/Notification'\r\n\r\n// returns nav bar, depending on login state & theme\r\nfunction Nav(props) {\r\n\r\n  const [dropdownOpen, setOpen] = useState(false);\r\n\r\n  const toggle = () => setOpen(!dropdownOpen);\r\n\r\n  const colors_dark = [\r\n    // [ primary, hover ]\r\n    [\"#FFD14D\", \"#FEBA04\"],\r\n    [\"#FFAD00\", \"#B97E00\"],\r\n    [\"#CF6679\", \"#B75463\"],\r\n    [\"#BB86FC\", \"#994AF1\"],\r\n    [\"#B8FF61\", \"#9BF900\"],\r\n    [\"#637FFF\", \"#0045EF\"],\r\n    [\"#63FFF9\", \"#00F7F7\"],\r\n    [\"#00FFAE\", \"#00F586\"],\r\n  ]\r\n\r\n  const colors_light = [\r\n    // [ primary, hover ]\r\n    [\"#804000\", \"#95BA23\"],\r\n    [\"#6B4900\", \"#755305\"],\r\n    [\"#723C47\", \"#834852\"],\r\n    [\"#005200\", \"#29811F\"],\r\n    [\"#1F1F1F\", \"#393939\"],\r\n    [\"#5F389C\", \"#7C59AF\"],\r\n    [\"#A30000\", \"#BF1C16\"],\r\n    [\"#0013E9\", \"#361DF1\"],\r\n  ];\r\n\r\n  function getColors(color){\r\n    var colorIndex, colorHover, secondColor, secondColorHover;\r\n\r\n    if(props.theme === \"dark\"){\r\n      colorIndex = colors_dark.findIndex(clr => clr[0] === color);\r\n      secondColor = colors_dark[(colorIndex + 5) % colors_dark.length][0]\r\n      secondColorHover = colors_dark[(colorIndex + 5) % colors_dark.length][1]\r\n      colorHover = colors_dark[colorIndex][1]\r\n    }\r\n    else{\r\n      colorIndex = colors_light.findIndex(clr => clr[0] === color);\r\n      secondColor = colors_light[(colorIndex + colors_light.length - 1) % colors_light.length][0]\r\n      secondColorHover = colors_light[(colorIndex + colors_light.length - 1) % colors_light.length][1]\r\n      colorHover = colors_light[colorIndex][1]\r\n    }\r\n\r\n    return { colorHover, secondColor, secondColorHover }\r\n  }\r\n\r\n  function changeColor(color){\r\n    const { colorHover, secondColor, secondColorHover } = getColors(color)\r\n    const cssStyles = [\r\n      ['--main-primary-' + props.theme, color],\r\n      ['--main-primary-hover-' + props.theme, colorHover],\r\n      ['--main-secondary-' + props.theme, secondColor],\r\n      ['--main-secondary-hover-' + props.theme, secondColorHover],\r\n    ];\r\n\r\n    cssStyles.map(item => {\r\n      localStorage.setItem(item[0], item[1])\r\n    })\r\n\r\n    ShowNotification(NOTIFY.CHANGE_COLOR, props.theme);\r\n  } \r\n\r\n  function previewColor(color = undefined){\r\n    color = color ?? localStorage.getItem(\"--main-primary-\" + props.theme);\r\n    const { colorHover, secondColor, secondColorHover } = getColors(color)\r\n\r\n    document.documentElement.style.setProperty(\"--main-primary-\" + props.theme, color)\r\n    document.documentElement.style.setProperty(\"--main-primary-hover-\" + props.theme, colorHover)\r\n    document.documentElement.style.setProperty(\"--main-secondary-\" + props.theme, secondColor)\r\n    document.documentElement.style.setProperty(\"--main-secondary-hover-\" + props.theme, secondColorHover)\r\n  }\r\n\r\n  const color_picker = (\r\n    <ButtonDropdown isOpen={dropdownOpen} toggle={toggle} className={\"color-picker \" + props.theme}>\r\n      <DropdownToggle>\r\n        <i className=\"fas fa-brush\" />\r\n      </DropdownToggle>\r\n      <DropdownMenu onMouseLeave={() => previewColor()}>\r\n        {props.theme === \"dark\" ? \r\n          (\r\n            colors_dark.map(color => \r\n              <DropdownItem \r\n                key={color[0]} \r\n                hidden={color[0] === localStorage.getItem('--main-primary-dark') ? true : false} \r\n                style={{backgroundColor: color[0]}} \r\n                onClick={() => changeColor(color[0])} \r\n                onMouseEnter={() => previewColor(color[0])}\r\n              />\r\n            )\r\n          ) : (\r\n            colors_light.map(color => \r\n              <DropdownItem \r\n                key={color[0]} \r\n                hidden={color[0] === localStorage.getItem('--main-primary-light') ? true : false} \r\n                style={{backgroundColor: color[0]}} \r\n                onClick={() => changeColor(color[0])}\r\n                onMouseEnter={() => previewColor(color[0])}\r\n              />\r\n            )\r\n          )\r\n        }\r\n      </DropdownMenu>\r\n    </ButtonDropdown>\r\n  );\r\n\r\n  const logged_out_nav = (\r\n    <div className=\"nav_buttons\">\r\n      {color_picker}\r\n      <button onClick={props.changeThemeMode} className={\"btn my-2 my-sm-0 nav_button \" + props.theme}><i className={props.theme === \"dark\" ? \"fas fa-sun\" : \"fa fa-moon\"} /></button>\r\n      <button onClick={() => props.display_form('signup')} className={\"btn my-2 my-sm-0 nav_button \" + props.theme}><i className=\"fas fa-user-plus\"></i></button>\r\n      <button onClick={() => props.display_form('login')} className={\"btn my-2 my-sm-0 nav_button \" + props.theme}><i className=\"fas fa-sign-in-alt\"></i></button>\r\n    </div>\r\n  );\r\n\r\n  const logged_in_nav = (\r\n    <div className=\"nav_buttons\">\r\n      <button onClick={() => \"#\"} className={\"btn my-2 my-sm-0 nav_button \" + props.theme}><span className=\"username\">{props.username}&nbsp;</span> <i className=\"far fa-user\"></i></button>\r\n      {color_picker}\r\n      <button onClick={props.changeThemeMode} className={\"btn my-2 my-sm-0 nav_button \" + props.theme}><i className={props.theme === \"dark\" ? \"fas fa-sun\" : \"fa fa-moon\"} /></button>\r\n      <button onClick={() => props.handle_logout('logout')} className={\"btn my-2 my-sm-0 nav_button \" + props.theme}><i className=\"fas fa-sign-out-alt\"></i></button>\r\n    </div>\r\n  );\r\n\r\n\r\n  return (\r\n    <nav className={\"navbar sticky-top navbar-\" + props.theme} id=\"nav\">\r\n      <div className={\"logo \" + props.theme}>\r\n        <div className=\"logo-img\" />\r\n        <a id=\"name\" className=\"navbar-brand\" href=\"#\">Familytree</a>\r\n      </div>\r\n      {props.logged_in ? logged_in_nav : logged_out_nav}\r\n    </nav>\r\n      \r\n  );\r\n\r\n}\r\n\r\nexport default Nav;","import React from 'react';\r\nimport './LoginSignupForm.css'\r\n\r\nclass LoginForm extends React.Component {\r\n  state = {\r\n    username: '',\r\n    password: ''\r\n  };\r\n\r\n  // handles change for any Form Field\r\n  handle_change = e => {\r\n    const name = e.target.name;\r\n    const value = e.target.value;\r\n    this.setState(prevstate => {\r\n      const newState = { ...prevstate };\r\n      newState[name] = value;\r\n      return newState;\r\n    });\r\n  };\r\n\r\n  render() {\r\n    return (\r\n      <div className={\"login-\"+this.props.theme}>\r\n        <form method=\"post\" onSubmit={e => this.props.handle_login(e, this.state)}>\r\n            <h2 className=\"sr-only\">Login Form</h2>\r\n            <div className=\"illustration\"><i className=\"far fa-user\"></i></div>\r\n            <div className=\"form-group\">\r\n              <input \r\n              className={\"form-control \" + this.props.theme}\r\n              type=\"text\"\r\n              name=\"username\" \r\n              placeholder=\"Username\" \r\n              value={this.state.username.toLowerCase()}\r\n              onChange={this.handle_change}\r\n              required \r\n              autoFocus\r\n              />\r\n            </div>\r\n            <div className=\"form-group\">\r\n              <input \r\n              className=\"form-control\" \r\n              type=\"password\" \r\n              name=\"password\" \r\n              placeholder=\"Password\" \r\n              data-testid=\"password\"\r\n              value={this.state.password}\r\n              onChange={this.handle_change}\r\n              required\r\n              />\r\n            </div>\r\n            <div className=\"form-group\"><button className=\"btn btn-primary btn-block\" type=\"submit\">Log In</button></div>\r\n          </form>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default LoginForm;","import React from 'react';\r\nimport './LoginSignupForm.css'\r\n\r\nclass SignupForm extends React.Component {\r\n  state = {\r\n    username: \"\",\r\n    password: \"\",\r\n  };\r\n\r\n  // handles change for any Form Field\r\n  handle_change = e => {\r\n    let { name, value } = e.target;\r\n    if (name === \"username\")\r\n      value = value.toLowerCase()\r\n    this.setState({ [name]: value });\r\n  };\r\n\r\n  // error handling, validates given form fields\r\n  validate(username, password){\r\n    return{\r\n      username: username.trim().length === 0,\r\n      password_number: password.trim().length === 0 || !(/\\d/.test(password)),\r\n      password_uppercase: password.trim().length === 0 || !(/[A-Z]/.test(password)),\r\n      password_lowercase: password.trim().length === 0 || !(/[a-z]/.test(password)),\r\n      password_nonalpha: password.trim().length === 0 || !(/[^\\w\\d\\s:]/.test(password)),\r\n      password_length: password.trim().length === 0 || !(/([^\\s]){8,}/.test(password)),\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const errors = this.validate(this.state.username, this.state.password);\r\n    const isEnabled = !Object.keys(errors).some(x => errors[x]); // button is disabled as long as error exists\r\n    return (\r\n      <div className={\"signup-\"+this.props.theme}>\r\n        <form  method=\"post\" onSubmit={e => this.props.handle_signup(e, this.state)}>\r\n            <h2 className=\"sr-only\">Register Form</h2>\r\n            <div className=\"illustration\"><i className=\"far fa-user\"></i></div>\r\n            <div className=\"form-group\">\r\n              <input \r\n              className={\"form-control \" + this.props.theme + (errors.username ? \" error\" : \"\")}\r\n              type=\"text\" \r\n              name=\"username\" \r\n              placeholder=\"Username\" \r\n              value={this.state.username}\r\n              onChange={this.handle_change}\r\n              required \r\n              autoFocus\r\n              />\r\n            </div>\r\n            <div className=\"form-group\">\r\n              <input \r\n              className={\"form-control\" + ((errors.password_number || errors.password_uppercase || errors.password_lowercase || errors.password_nonalpha || errors.password_length) ? \" error\" : \"\")}\r\n              type=\"password\" \r\n              name=\"password\" \r\n              placeholder=\"Password\"\r\n              value={this.state.password}\r\n              onChange={this.handle_change}\r\n              required\r\n              />\r\n            </div>\r\n            <div className={\"form-group password-req \" + this.props.theme}>\r\n              <ul>\r\n                <span className={((errors.password_number || errors.password_uppercase || errors.password_lowercase || errors.password_nonalpha || errors.password_length) ? 'errortext ' : '') + this.props.theme}>Password must contain at least:</span>\r\n                <li className={(errors.password_number ? \"errortext \" : \" \") + this.props.theme}> 1 number (0-9) </li>\r\n                <li className={(errors.password_uppercase ? \"errortext \" : \" \") + this.props.theme}> 1 uppercase letters </li>\r\n                <li className={(errors.password_lowercase ? \"errortext \" : \" \") + this.props.theme}> 1 lowercase letters </li>\r\n                <li className={(errors.password_nonalpha ? \"errortext \" : \" \") + this.props.theme}> 1 non-alpha numeric number </li>\r\n                <li className={(errors.password_length ? \"errortext \" : \" \") + this.props.theme}> 8 characters with no space </li>\r\n              </ul>\r\n            </div>\r\n            <div className=\"form-group\"><button disabled={!isEnabled} className=\"btn btn-primary btn-block\" type=\"submit\">Register</button></div>\r\n          </form>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default SignupForm;","// frontend/src/components/MilestoneAddModal.js\r\n/*eslint no-useless-computed-key: 0*/\r\n/*eslint array-callback-return: 0*/\r\n\r\n    import React, { Component } from \"react\";\r\n    import axios from \"axios\";\r\n    import DatePicker from \"react-datepicker\";\r\n    import 'react-datepicker/dist/react-datepicker.css';\r\n    import MultiSelect from \"@khanacademy/react-multi-select\";    \r\n    import {NOTIFY} from '../Enums.ts';\r\n    import ShowNotification from '../notification/Notification';\r\n    import '../Modal.css';\r\n    import moment from 'moment';\r\n    import Dropzone from 'react-dropzone'\r\n    \r\n    import {\r\n      Button,\r\n      Modal,\r\n      ModalHeader,\r\n      ModalBody,\r\n      ModalFooter,\r\n      Form,\r\n      FormGroup,\r\n      Input,\r\n      Label\r\n    } from \"reactstrap\";\r\n\r\n    export default class CustomModal extends Component {\r\n      constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n          activeItem: this.props.activeItem,\r\n          personSelectOptions: [],\r\n          fileMessage: \"Drag 'n' drop file here, or click to select file\",\r\n        };\r\n      }\r\n\r\n      componentDidMount(){\r\n        var options = [];\r\n        axios\r\n          .get(\"/api/familytreepersons/\", {\r\n            headers: { Authorization: `JWT ${localStorage.getItem('token')}`}\r\n          })\r\n          .then(res => {\r\n            Array.from(res.data).map(item => {\r\n              options.push({\r\n                label: item.first_name + \" \" + item.last_name,\r\n                value: item.id,\r\n              });\r\n            });\r\n            this.setState({personSelectOptions: options});\r\n          })\r\n          .catch(err => {\r\n            console.log(err);\r\n            ShowNotification(NOTIFY.ERROR, this.props.theme);\r\n          });\r\n      }\r\n\r\n      // handles change for form fields except Date, File & Select\r\n      handleChange = (e) => {\r\n        let { name, value } = e.target;\r\n        const activeItem = { ...this.state.activeItem, [name]: value};\r\n        this.setState({ activeItem });\r\n      };\r\n\r\n      // handles change for Date Field\r\n      handleChangeDate = date => {\r\n        var dt;\r\n        try{\r\n          dt = moment(date).format('YYYY-MM-DD')\r\n        }\r\n        catch(RangeError){\r\n          dt = \"\";\r\n        }\r\n        const activeItem = { ...this.state.activeItem, [\"date\"]: dt};\r\n        this.setState({activeItem});\r\n      };\r\n\r\n      // handles change for File Field\r\n      handleChangeFile = (file) => {\r\n        var fileMessage = \"Drag 'n' drop file here, or click to select file\";\r\n\r\n      if(file !== null){\r\n        fileMessage = file.name;\r\n      }\r\n        const activeItem = { ...this.state.activeItem, [\"image\"]: file};\r\n        this.setState({activeItem, fileMessage});\r\n      }\r\n\r\n      handleChangeSelect = selected => {\r\n        const activeItem = { ...this.state.activeItem, [\"person_id\"]: selected.filter(el => el !== undefined)};\r\n        this.setState({activeItem});\r\n      }\r\n      \r\n      // error handling, validates given fields\r\n      validate(form){\r\n        var file_extension_invalid = false;\r\n        if(form.image !== null && form.image !== undefined && form.image.name !== undefined){\r\n          var extensions = ['.jpg', '.jpeg', '.png', '.gif', '.bmp', '.svg', '.raw', '.mp4', '.webm', '.wmv', '.avi', '.wav', '.mp3'];\r\n          var file_ext_check = false;\r\n          extensions.map(ext => {\r\n            var file_ext = form.image.name.substring(form.image.name.lastIndexOf('.'))\r\n            if(ext === file_ext){\r\n              file_ext_check = true;\r\n            }\r\n          })\r\n\r\n          if(!file_ext_check){ file_extension_invalid = true;}\r\n        }\r\n\r\n        try{\r\n          form.person_id = form.person_id.filter(el => el !== undefined);\r\n        }\r\n        catch(TypeError){\r\n          form.person_id = []\r\n        }\r\n\r\n        return{\r\n          title: form.title.trim().length === 0,\r\n          title_too_long: form.title.trim().length > 64,\r\n          text: form.text.trim().length > 512,\r\n          date: form.date.toString().trim().length === 0 || !(moment(form.date.toString(), \"YYYY-MM-DD\").isValid()),\r\n          person_id: form.person_id.length === 0,\r\n          file_extension: file_extension_invalid,\r\n          file: (form.image === null || form.image === undefined) && form.id === undefined,\r\n        }\r\n      }\r\n\r\n      render() {\r\n        const { toggle, onSave } = this.props;\r\n        const errors = this.validate(this.state.activeItem);\r\n        const isEnabled = !Object.keys(errors).some(x => errors[x]); // button is disables as long as error exists\r\n        return (\r\n          <Modal className={\"modal-open-\"+this.props.theme} isOpen={true} toggle={toggle}>\r\n            <ModalHeader className={\"modal-header-\"+this.props.theme} toggle={toggle}> Milestone </ModalHeader>\r\n            <ModalBody className={\"modal-body-\"+this.props.theme}>\r\n              <Form>\r\n              <FormGroup>\r\n                  <Label for=\"title\">Title</Label>\r\n                  <Input\r\n                    type=\"text\"\r\n                    name=\"title\"\r\n                    className={this.props.theme + ((errors.title || errors.title_too_long) ? \" error\" : \"\")}\r\n                    value={this.state.activeItem.title}\r\n                    onChange={this.handleChange}\r\n                    placeholder=\"Title\"\r\n                  />\r\n                  {errors.title?(<small className={'errortext ' + this.props.theme}>Please insert title</small>):null}\r\n                  {errors.title_too_long?(<small className={'errortext ' + this.props.theme}>This title is too long, max length is 64</small>):null}\r\n                </FormGroup>\r\n                <FormGroup>\r\n                  <Label for=\"text\">Text</Label>\r\n                  <Input\r\n                    type=\"text\"\r\n                    name=\"text\"\r\n                    className={\"form-control \" + this.props.theme + (errors.text ? \" error\" : \"\")}\r\n                    value={this.state.activeItem.text}\r\n                    onChange={this.handleChange}\r\n                    placeholder=\"Text\"\r\n                  />\r\n                  {errors.text?(<small className={'errortext ' + this.props.theme}>This text is too long, max length is 512</small>):null}\r\n                </FormGroup>\r\n                <FormGroup>\r\n                  <Label for=\"date\">Date</Label><br />\r\n                  <DatePicker \r\n                    name=\"date\"\r\n                    className={\"form-control \" + this.props.theme + (errors.date ? \" error\" : \"\")}\r\n                    value={this.state.activeItem.date}\r\n                    onChange={ this.handleChangeDate} \r\n                    peekNextMonth\r\n                    showMonthDropdown\r\n                    showYearDropdown\r\n                    dropdownMode=\"select\"/>\r\n                    {errors.date?(<small className={'errortext ' + this.props.theme}>Please choose date</small>):null}\r\n                </FormGroup>\r\n                <FormGroup>\r\n                  <Label for=\"person_id\">Persons {errors.person_id ? \"\" : null}</Label><br />\r\n                  <MultiSelect\r\n                    name=\"multiselect\"\r\n                    options={this.state.personSelectOptions}\r\n                    className={\"form-control \" + this.props.theme + (errors.person_id && this.state.activeItem.id === undefined ? \" error\" : \"\")}\r\n                    selected={this.state.activeItem.person_id}\r\n                    onSelectedChanged={this.handleChangeSelect}\r\n                  />\r\n                  {errors.person_id?(<small className={'errortext ' + this.props.theme}> Please, choose at least one person from the list</small>):null}\r\n                  </FormGroup>\r\n                  <FormGroup>\r\n                    <Label for=\"imageUrl\">Image/Movie</Label>\r\n                    <Dropzone \r\n                        onDrop={acceptedFiles => this.handleChangeFile(acceptedFiles[0])}\r\n                        onFileDialogCancel={() => this.handleChangeFile(null)}\r\n                        multiple={false}\r\n                      >\r\n                        {({getRootProps, getInputProps}) => (\r\n                          <section>\r\n                            <div {...getRootProps()} className={\"dropzone \" + this.props.theme + ((errors.file || errors.file_extension) ? \" error\" : \"\")}>\r\n                              <input {...getInputProps()} />\r\n                              <p>{this.state.fileMessage}</p>\r\n                            </div>\r\n                          </section>\r\n                        )}\r\n                      </Dropzone>\r\n                      {errors.file?(<small className={'errortext ' + this.props.theme}>Please upload Media File<br/></small>):null}\r\n                      {errors.file_extension?(<small className={'errortext ' + this.props.theme}>This File has unsupported extension. Supported extensions: <b>JPG, PNG, GIF, BMP, SVG, RAW, MP4, WEBM, WMV, AVI, WAV, MP3</b></small>):null}\r\n                  </FormGroup>\r\n              </Form>\r\n            </ModalBody>\r\n            <ModalFooter className={\"modal-footer-\"+this.props.theme}>\r\n              <Button disabled={!isEnabled} className=\"confirm\" onClick={() => onSave(this.state.activeItem)}>\r\n                Save\r\n              </Button>\r\n            </ModalFooter>\r\n          </Modal>\r\n        );\r\n      }\r\n    }","// frontend/src/components/RelationshipModal.js\r\n/*eslint no-useless-computed-key: 0*/\r\n\r\n    import React, { Component } from \"react\";\r\n    import DatePicker from \"react-datepicker\";\r\n    import 'react-datepicker/dist/react-datepicker.css';\r\n    import axios from \"axios\";\r\n    import {NOTIFY} from '../Enums.ts';\r\n    import ShowNotification from '../notification/Notification';\r\n    import '../Modal.css';\r\n    import moment from 'moment';\r\n\r\n    import {\r\n      Button,\r\n      CustomInput,\r\n      Modal,\r\n      ModalHeader,\r\n      ModalBody,\r\n      ModalFooter,\r\n      Form,\r\n      FormGroup,\r\n      Input,\r\n      Label\r\n    } from \"reactstrap\";\r\n\r\n    export default class CustomModal extends Component {\r\n      constructor(props) {\r\n        super(props);\r\n        this.state = { \r\n          activeItem: this.props.activeItem,\r\n          touched: {\r\n            title: false,\r\n            begin_date: false,\r\n            end_date: false,\r\n          },\r\n          personList: [],\r\n        };\r\n      }\r\n\r\n      componentWillMount(){\r\n        this.refreshPersonList();\r\n      }\r\n\r\n      // if it's new relationship, then generate color\r\n      componentDidMount(){ \r\n        if(this.state.activeItem.color === \"\"){\r\n          const activeItem = { ...this.state.activeItem, [\"color\"]: this.genColor()};\r\n          this.setState({ activeItem });\r\n        }\r\n      }\r\n\r\n      // used only to get person's names from their ID's\r\n      refreshPersonList = () => {\r\n        axios\r\n          .get(\"/api/familytreepersons/\", {\r\n            headers: { Authorization: `JWT ${localStorage.getItem('token')}`}\r\n          })\r\n          .then(res => this.setState({ personList: res.data }))\r\n          .catch(err => {\r\n            console.log(err);\r\n            ShowNotification(NOTIFY.ERROR);\r\n          });\r\n      };\r\n\r\n      // handles Form changes for any field except date & select\r\n      handleChange = (e) => {\r\n        let { name, value } = e.target;\r\n        const activeItem = { ...this.state.activeItem, [name]: value};\r\n        this.setState({ activeItem }, () => name === 'relationships' ? this.handleChangeDescendant(value) : null);\r\n      };\r\n\r\n      handleChangeDescendant = (value) => {\r\n        var twoLvl = ['niece/nephew', 'child', 'adopted child']\r\n        var activeItem = { ...this.state.activeItem, [\"descendant\"]: false};\r\n        if(twoLvl.indexOf(value) !== -1){\r\n          activeItem = { ...this.state.activeItem, [\"descendant\"]: true};\r\n        }\r\n        this.setState({ activeItem });\r\n      };\r\n\r\n      // gets person's first & last name by using only its ID\r\n      getPerson(idPerson){\r\n        if(this.state.personList.length === 0 ||this.state.personList.length === undefined ){ return \"\" }\r\n        var targetPerson = Array.from(this.state.personList).find(item => item.id === idPerson); // find certain person in personList\r\n        return targetPerson.first_name + \" \" + targetPerson.last_name;\r\n      }\r\n\r\n      // generates color for relationship\r\n      genColor(){\r\n        var randomColor = require('random-color');\r\n        var color = randomColor(0.3, 0.99); // light color\r\n        return color.hexString();\r\n      }\r\n\r\n      // error handling\r\n      handleBlur = (field) => (evt) => {\r\n        this.setState({\r\n          touched: { ...this.state.touched, [field]: true },\r\n        });\r\n      }\r\n\r\n      // handle Form changes for Begin Date field\r\n      handleChangeBeginDate = date => {\r\n        var dt;\r\n        try{\r\n          dt = moment(date).format('YYYY-MM-DD');\r\n        }\r\n        catch(RangeError){\r\n          dt = \"\";\r\n        }\r\n        const activeItem = { ...this.state.activeItem, [\"begin_date\"]: dt};\r\n        this.setState({activeItem});\r\n      };\r\n\r\n      // handle Form changes for End Date field\r\n      handleChangeEndDate = date => {\r\n        var dt;\r\n        try{\r\n          dt = moment(date).format('YYYY-MM-DD');\r\n        }\r\n        catch(RangeError){\r\n          dt = \"\";\r\n        }\r\n        const activeItem = { ...this.state.activeItem, [\"end_date\"]: dt};\r\n        this.setState({activeItem});\r\n      };\r\n\r\n      // error handling, validates fields\r\n      validate(form){\r\n        return{\r\n          title: form.title.trim().length === 0,\r\n          title_too_long: form.title.trim().length > 64,\r\n          description: form.description.trim().length > 512,\r\n          begin_date: form.begin_date.toString().trim().length === 0 || !(moment(form.begin_date.toString(), \"YYYY-MM-DD\").isValid()),\r\n          end_date_earlier_than_begin: form.end_date !== null && form.end_date !== undefined && form.end_date !== \"\" && form.end_date.toString().trim() < form.begin_date.toString().trim(),\r\n        }\r\n      }\r\n\r\n      render() {\r\n        const { toggle, onSave } = this.props;\r\n        const errors = this.validate(this.state.activeItem);\r\n        const isEnabled = !Object.keys(errors).some(x => errors[x]); // button is disabled as long as error exists\r\n        return (\r\n          <Modal className={\"modal-open-\"+this.props.theme} isOpen={true} toggle={toggle}>\r\n            <ModalHeader className={\"modal-header-\"+this.props.theme} toggle={toggle}> Relationship</ModalHeader>\r\n            <ModalBody className={\"modal-body-\"+this.props.theme}>\r\n              <Form>\r\n                <FormGroup>\r\n                  <Label for=\"title\">Title</Label>\r\n                  <Input\r\n                    type=\"text\"\r\n                    name=\"title\"\r\n                    className={this.props.theme + ((errors.title || errors.title_too_long) ? \" error\" : \"\")}\r\n                    onBlur={this.handleBlur('title')}\r\n                    value={this.state.activeItem.title}\r\n                    onChange={this.handleChange}\r\n                    placeholder=\"Title\"\r\n                  />\r\n                  {errors.title ? (<small className={'errortext ' + this.props.theme}>Please insert title</small>) : null}\r\n                  {errors.title_too_long ? (<small className={'errortext ' + this.props.theme}>This title is too long, max length is 64</small>) : null}\r\n                </FormGroup>\r\n                <FormGroup>\r\n                  <Label for=\"description\">Description</Label>\r\n                  <Input\r\n                    type=\"text\"\r\n                    name=\"description\"\r\n                    className={this.props.theme + (errors.description ? \" error\" : \"\")}\r\n                    value={this.state.activeItem.description}\r\n                    onChange={this.handleChange}\r\n                    placeholder=\"Description\"\r\n                  />\r\n                  {errors.description ? (<small className={'errortext ' + this.props.theme}>This description is too long, max length is 512</small>) : null}\r\n                </FormGroup>\r\n                <FormGroup>\r\n                  <Label for=\"begin_date\">Begin Date</Label><br />\r\n                  <DatePicker \r\n                    name=\"begin_date\"\r\n                    className={\"form-control \" + this.props.theme + (errors.begin_date ? \" error\" : \"\")}\r\n                    value={this.state.activeItem.begin_date}\r\n                    onChange={ this.handleChangeBeginDate} \r\n                    onBlur={this.handleBlur('begin_date')}\r\n                    peekNextMonth\r\n                    showMonthDropdown\r\n                    showYearDropdown\r\n                    dropdownMode=\"select\"/>\r\n                  {errors.begin_date ? (<small className={'errortext ' + this.props.theme}>Please insert begin date</small>) : null}\r\n                </FormGroup>\r\n                <FormGroup>\r\n                  <Label for=\"end_date\">End date (optional)</Label><br />\r\n                  <DatePicker \r\n                    name=\"end_date\"\r\n                    className={\"form-control \" + this.props.theme + (errors.end_date_earlier_than_begin ? \" error\" : \"\")}\r\n                    value={this.state.activeItem.end_date}\r\n                    onChange={ this.handleChangeEndDate} \r\n                    peekNextMonth\r\n                    showMonthDropdown\r\n                    showYearDropdown\r\n                    dropdownMode=\"select\"/>\r\n                  {errors.end_date_earlier_than_begin ? (<small className={'errortext ' + this.props.theme}>End date can't be earlier than begin date. We don't support time travel</small>) : null}\r\n                </FormGroup>\r\n                <FormGroup>\r\n                  <Label for=\"relationships\">What's {this.getPerson(this.state.activeItem.id_2)} to the {this.getPerson(this.state.activeItem.id_1)}</Label>\r\n                  <CustomInput \r\n                    id=\"relationships\"\r\n                    type=\"select\"\r\n                    className={\"form-control \" + this.props.theme}\r\n                    name = \"relationships\"\r\n                    onChange={this.handleChange}\r\n                    value={this.state.activeItem.relationships}\r\n                  >\r\n                    <option value=\"married\">Married</option>\r\n                    <option value=\"divorced\">Divorced</option>\r\n                    <option value=\"fiance\">Fiance</option>\r\n                    <option value=\"sibling\">Sibling</option>\r\n                    <option value=\"stepsibling\">Step Sibling</option>\r\n                    <option value=\"sibling-in-law\">Sibling-in-law</option>\r\n                    <option value=\"cousin\">Cousin</option>\r\n                    <option value=\"niece/nephew\">Niece/Nephew</option>\r\n                    <option value=\"child\">Child</option>\r\n                    <option value=\"adopted child\">Adopted Child</option>\r\n                  </CustomInput>\r\n                </FormGroup>\r\n              </Form>\r\n            </ModalBody>\r\n            <ModalFooter className={\"modal-footer-\"+this.props.theme}>\r\n              <Button disabled={!isEnabled} className=\"confirm\" onClick={() => onSave(this.state.activeItem)}>\r\n                Save\r\n              </Button>\r\n            </ModalFooter>\r\n          </Modal>\r\n        );\r\n      }\r\n    }","// frontend/src/components/PersonEditTimelineModal.js\r\n/*eslint array-callback-return: 0*/\r\n/*eslint no-useless-computed-key: 0*/\r\n\r\n    import React, { Component } from \"react\";\r\n    import DatePicker from \"react-datepicker\";\r\n    import Timeline from 'react-image-timeline';\r\n    import 'react-datepicker/dist/react-datepicker.css';\r\n    import './PersonEdit.css'\r\n    import '../Modal.css'\r\n    import 'react-image-timeline/dist/timeline.css';\r\n    import axios from \"axios\";\r\n    import {NOTIFY} from '../Enums.ts';\r\n    import ShowNotification from '../notification/Notification';\r\n    import Switch from \"react-switch\";\r\n    import ModalMilestone from './MilestoneModal'\r\n    import ModalRelationship from '../relationship/RelationshipModal'\r\n    import ReactPlayer from 'react-player'\r\n    import moment from 'moment'\r\n    import Dropzone from 'react-dropzone'\r\n    \r\n    import {\r\n      Button,\r\n      CustomInput,\r\n      Col,\r\n      Modal,\r\n      ModalHeader,\r\n      ModalBody,\r\n      ModalFooter,\r\n      Row,\r\n      Form,\r\n      FormGroup,\r\n      Input,\r\n      Label,\r\n    } from \"reactstrap\";\r\n\r\n    function getRelativePath(mediaFile){\r\n      return mediaFile.substring(mediaFile.indexOf('/media'))\r\n    }\r\n\r\n    // custom header for Timeline component, consists of different date format (yyyy-mm-dd)\r\n    const CustomHeader = (props) => {\r\n      const {title, date, extras} = props.event;\r\n      return (\r\n        <div className=\"custom-header\">\r\n          <h2 className=\"rt-title\">{title}</h2>\r\n          <p className=\"rt-date\">{(new Date(date)).toISOString().slice(0, 10)}</p>\r\n          {extras !== null && extras.theme !== undefined ? (<hr className={\"hr-body \" + extras.theme}/>) : null}\r\n        </div>\r\n      )\r\n    }\r\n\r\n    // custom image body for Timeline to support media type files (ReactPlayer component) along with images\r\n    const CustomImageBody = (props) => {\r\n      const { imageUrl } = props.event;\r\n      return (\r\n        <div className=\"custom-image-body\">\r\n          {ReactPlayer.canPlay(imageUrl) ? <ReactPlayer url={getRelativePath(imageUrl)} controls={true} width='100%' height='100%'/> : <img src={getRelativePath(imageUrl)} alt=\"\" className=\"rt-image\" />}\r\n        </div>\r\n      );\r\n    };\r\n\r\n    // custom text body for Timeline to include end date of relationship, type of relationship & comrades\r\n    const CustomTextBody = (props) => {\r\n      const {text, extras} = props.event;\r\n      return (\r\n        <div className=\"custom-text-body\">\r\n          {extras !== null && extras.theme !== undefined ? (<hr className={\"hr-body \" + extras.theme}/>) : null}\r\n          <p>{text}</p>\r\n          <p><b>{extras !== null && extras.end_date !== undefined && extras.end_date !== null? \"End: \" + extras.end_date + \"\\n\": \"\"}</b></p>\r\n          <p><b>{extras !== null && extras.relationship !== undefined ? \"Type: \" + extras.relationship : \"\"}</b></p>\r\n          <p><b>{extras !== null && extras.together_with !== undefined && extras.together_with.length ? \"Together with: \" + extras.together_with.join(\", \") : \"\"}</b></p>\r\n          {extras !== null && extras.theme !== undefined ? (<hr className={\"hr-body \" + extras.theme}/>) : null}\r\n        </div>\r\n      );\r\n    }\r\n\r\n    export default class CustomModal extends Component {\r\n      constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n          activeItem: this.props.activeItem,\r\n          activeMilestone: [],\r\n          activeRelationship: [],\r\n          touched: {\r\n            first_name: false,\r\n            last_name: false,\r\n          },\r\n          timelineData: [], // data used for Timeline\r\n          deleteMode: false, // flag, if delete mode is enabled\r\n          personList: [], // list of Persons\r\n          fileMessage: \"Drag 'n' drop file here, or click to select file\",\r\n        };\r\n      }\r\n\r\n      componentDidMount(){\r\n        this.refreshPersonList();\r\n      }\r\n\r\n      refreshPersonList = () => {\r\n        axios\r\n          .get(\"/api/familytreepersons/\", {\r\n            headers: { Authorization: `JWT ${localStorage.getItem('token')}`}\r\n          })\r\n          .then(res => this.setState({ personList: res.data }))\r\n          .then(this.downloadTimelineData())\r\n          .catch(err => {\r\n            console.log(err);\r\n            ShowNotification(NOTIFY.ERROR, this.props.theme);\r\n          });\r\n      };\r\n\r\n      // downloads data from API, if it fails to download any type of data, then it don't display anything (to not mix up in users' head)\r\n      downloadTimelineData(){\r\n        var data = [];\r\n        // firstly, download all milestones for certain Person\r\n        axios\r\n        .get(\"/api/familytreemilestone/\", {\r\n          headers: { Authorization: `JWT ${localStorage.getItem('token')}`},\r\n          params: { person_id: this.props.activeItem.id }\r\n        })\r\n        .then(res => {\r\n          Array.from(res.data).map(item => {\r\n            var dateStr = item.date.split(\"-\");\r\n            var togetherWithNames = [];\r\n            var togetherWith = this.state.personList.filter(el => el.id !== this.props.activeItem.id && item.person_id.includes(el.id));\r\n\r\n            togetherWith.map(person => {\r\n              togetherWithNames.push(person.first_name + \" \" + person.last_name);\r\n            })\r\n\r\n            data.push({\r\n              date: new Date(parseInt(dateStr[0]), parseInt(dateStr[1]) - 1, parseInt(dateStr[2])), // new Date uses months indexes, so 0-11 instead of 1-12; strange but true\r\n              text: item.text,\r\n              title: item.title,\r\n              buttonText: (this.state.deleteMode ? \"Delete\" : \"Edit\") + \" Milestone\",\r\n              imageUrl: item.image,\r\n              extras: {\r\n                together_with: togetherWithNames,\r\n                theme: this.props.theme,\r\n              },\r\n              onClick: () => { this.state.deleteMode ? this.props.toggleConfirmModal(\"Delete Milestone\", \"Are you sure you want to delete this milestone?\", \"Delete\", \"Cancel\", () => this.handleDeleteMilestone(item)) : this.editMilestone(item) }\r\n            });\r\n          });\r\n        })\r\n        .then( () => {\r\n          // then, download all relationship for certain Person, where it's 1st person in relationship\r\n          axios\r\n          .get(\"/api/familytreerelationship/\", {\r\n            headers: { Authorization: `JWT ${localStorage.getItem('token')}`},\r\n            params: { id_1: this.props.activeItem.id }\r\n          })\r\n          .then(res => {\r\n            Array.from(res.data).map(item => {\r\n              var dateStr = item.begin_date.split(\"-\");\r\n              var togetherWithNames = [];\r\n              var togetherWith = this.state.personList.filter(el => el.id !== this.props.activeItem.id && el.id === item.id_2);\r\n\r\n              togetherWith.map(person => {\r\n                togetherWithNames.push(person.first_name + \" \" + person.last_name);\r\n              })\r\n\r\n              data.push({\r\n                date: new Date(parseInt(dateStr[0]), parseInt(dateStr[1]) - 1, parseInt(dateStr[2])), // new Date uses months indexes, so 0-11 instead of 1-12; strange but true\r\n                text: item.description,\r\n                title: item.title,\r\n                buttonText: (this.state.deleteMode ? \"Delete\" : \"Edit\") + \" Relationship\",\r\n                imageUrl: \"/media/milestones/default.jpg\",\r\n                extras: {\r\n                  end_date: item.end_date,\r\n                  relationship: item.relationships,\r\n                  together_with: togetherWithNames,\r\n                  theme: this.props.theme,\r\n                },\r\n                onClick: () => { this.state.deleteMode ? this.props.toggleConfirmModal(\"Delete Relationship\", \"Are you sure you want to delete this relationship?\", \"Delete\", \"Cancel\", () => this.handleDeleteRelationship(item)) : this.editRelationship(item)}\r\n              })\r\n            })\r\n          })\r\n          .then( () => {\r\n            // then, download remaining relationship for certain Person, where it's 2nd person in relationship\r\n            axios\r\n            .get(\"/api/familytreerelationship/\", {\r\n              headers: { Authorization: `JWT ${localStorage.getItem('token')}`},\r\n              params: { id_2: this.props.activeItem.id }\r\n            })\r\n            .then(res => {\r\n              Array.from(res.data).map(item => {\r\n                var dateStr = item.begin_date.split(\"-\");\r\n                var togetherWithNames = [];\r\n                var togetherWith = this.state.personList.filter(el => el.id !== this.props.activeItem.id && el.id === item.id_1);\r\n\r\n                togetherWith.map(person => {\r\n                  togetherWithNames.push(person.first_name + \" \" + person.last_name);\r\n                })\r\n\r\n                data.push({\r\n                  date: new Date(parseInt(dateStr[0]), parseInt(dateStr[1]) - 1, parseInt(dateStr[2])), // new Date uses months indexes, so 0-11 instead of 1-12; strange but true\r\n                  text: item.description,\r\n                  title: item.title,\r\n                  buttonText: (this.state.deleteMode ? \"Delete\" : \"Edit\") + \" Relationship\",\r\n                  imageUrl: \"/media/milestones/default.jpg\",\r\n                  extras: {\r\n                    end_date: item.end_date,\r\n                    relationship: item.relationships,\r\n                    together_with: togetherWithNames,\r\n                    theme: this.props.theme,\r\n                  },\r\n                  onClick: () => { this.state.deleteMode ? this.props.toggleConfirmModal(\"Delete Relationship\", \"Are you sure you want to delete this relationship?\", \"Delete\", \"Cancel\", () => this.handleDeleteRelationship(item)) : this.editRelationship(item)}\r\n                })\r\n              });\r\n              this.setState({timelineData: data});\r\n            })\r\n          })\r\n        })\r\n        .catch(err => {\r\n          console.log(err);\r\n          ShowNotification(NOTIFY.ERROR, this.props.theme);\r\n          this.setState({timelineData: []});\r\n        });\r\n      }\r\n\r\n      // prepares form for creating new Milestone\r\n      createMilestone = () => {\r\n        this.setState({ activeMilestone: {\r\n          user_id: localStorage.getItem(\"user_id\"),\r\n          person_id: [this.props.id],\r\n          date: \"\",\r\n          title: \"\",\r\n          text: \"\",\r\n          image: undefined\r\n        }, ModalMilestone: !this.state.ModalMilestone });\r\n      }\r\n\r\n      // prepares form for editing existing Milestone\r\n      editMilestone = item => {\r\n        this.setState({ activeMilestone: item, ModalMilestone: !this.state.ModalMilestone });\r\n      };\r\n\r\n      // prepares form for editin existin Relationship\r\n      editRelationship = item => {\r\n        this.setState({ activeRelationship: item, ModalRelationship: !this.state.ModalRelationship });\r\n      };\r\n      \r\n      // handles new/existing milestone submission\r\n      handleSubmitMilestone = (item) => {\r\n        this.toggleMilestoneModal();\r\n        var SHA256, newFilename, oldItem, i;\r\n\r\n        item.person_id = item.person_id.filter(el => el !== undefined); // makes sure there is no 'undefined' person i chosen Person List\r\n\r\n        // if Milestone already exists\r\n        if (item.id) {\r\n          SHA256 = require(\"crypto-js/sha256\");\r\n          newFilename = item.image !== null && item.image.name !== undefined ? SHA256(Date.now().toString() + item.image.name) + item.image.name.substring(item.image.name.indexOf(\".\")) : null; // SHA256 encryption for filename (media/image)\r\n          oldItem = this.props.activeItem;\r\n\r\n          let data = new FormData();\r\n        \r\n          if(oldItem.user_id !== item.user_id) data.append('user_id', item.user_id);\r\n          for(i = 0; i < item.person_id.length; i++){\r\n            data.append('person_id', item.person_id[i]);\r\n          }\r\n          if(oldItem.date !== item.date) data.append('date', item.date);\r\n          if(oldItem.text !== item.text) data.append('text', item.text);\r\n          if(oldItem.title !== item.title) data.append('title', item.title);\r\n          if(oldItem.image !== item.image && item.image !== null && newFilename !== null) data.append('image', item.image, newFilename); // sha256 encryption\r\n\r\n          axios\r\n          .patch(`/api/familytreemilestone/${item.id}/`, data, {\r\n            headers: {\r\n              'Content-Type': 'multipart/form-data',\r\n              Authorization: `JWT ${localStorage.getItem('token')}`\r\n            }\r\n          })\r\n            .then(() => this.downloadTimelineData())\r\n            .then(() => ShowNotification(NOTIFY.SAVE_MILESTONE, this.props.theme))\r\n            .catch(err => {\r\n              console.log(err);\r\n              ShowNotification(NOTIFY.ERROR, this.props.theme);\r\n            });\r\n          return;\r\n        }\r\n\r\n        // if there is no Milestone w/ provided ID\r\n        SHA256 = require(\"crypto-js/sha256\"); \r\n        newFilename = SHA256(Date.now().toString() + item.image.name) + item.image.name.substring(item.image.name.indexOf(\".\")); // SHA256 encryption for filename (media/image)\r\n\r\n        let data = new FormData();\r\n        data.append('user_id', item.user_id);\r\n        \r\n        for(i = 0; i < item.person_id.length; i++){\r\n          data.append('person_id', item.person_id[i]);\r\n        }\r\n\r\n        data.append('date', item.date);\r\n        data.append('text', item.text);\r\n        data.append('title', item.title);\r\n        data.append('image', item.image, newFilename); // sha256 encryption\r\n\r\n        axios.post('/api/familytreemilestone/', data, {\r\n          headers: {\r\n            'Content-Type': 'multipart/form-data',\r\n            Authorization: `JWT ${localStorage.getItem('token')}`\r\n          }\r\n        })\r\n          .then(() => this.downloadTimelineData())\r\n          .then(() => ShowNotification(NOTIFY.ADD_MILESTONE, this.props.theme))\r\n          .catch(err => {\r\n            console.log(err);\r\n            ShowNotification(NOTIFY.ERROR, this.props.theme);\r\n          });\r\n      };\r\n\r\n      // handles submission of existing Relationship\r\n      handleSubmitRelationship = item => {\r\n        this.toggleRelationshipModal();        \r\n        if (item.id) {\r\n          axios.put(`/api/familytreerelationship/${item.id}/`, item, {\r\n            headers: {\r\n              'Content-Type': 'application/json',\r\n              Authorization: `JWT ${localStorage.getItem('token')}`\r\n            }\r\n          })\r\n            .then(() => this.downloadTimelineData())\r\n            .then(() => this.props.refreshRelationships())\r\n            .then(() => ShowNotification(NOTIFY.SAVE_RELATIONSHIP, this.props.theme))\r\n            .catch(err => {\r\n              console.log(err);\r\n              ShowNotification(NOTIFY.ERROR, this.props.theme);\r\n            });\r\n          return;\r\n        } \r\n      };\r\n\r\n      // handles deletetion of existing Milestone\r\n      handleDeleteMilestone = item => {\r\n        this.props.toggleConfirmModal();\r\n        axios\r\n          .delete(`/api/familytreemilestone/${item.id}`, {\r\n            headers: { Authorization: `JWT ${localStorage.getItem('token')}`}\r\n          })\r\n          .then(() => this.downloadTimelineData())\r\n          .then(() => ShowNotification(NOTIFY.DELETE_MILESTONE, this.props.theme))\r\n          .catch(err => {\r\n            console.log(err);\r\n            ShowNotification(NOTIFY.ERROR, this.props.theme);\r\n          });\r\n      };\r\n\r\n      // handles deletion of existing Relationship\r\n      handleDeleteRelationship = item => {\r\n        this.props.toggleConfirmModal();\r\n        axios\r\n          .delete(`/api/familytreerelationship/${item.id}`, {\r\n            headers: { Authorization: `JWT ${localStorage.getItem('token')}`}\r\n          })\r\n          .then(() => this.downloadTimelineData())\r\n          .then(() => this.props.refreshRelationships())\r\n          .then(() => ShowNotification(NOTIFY.DELETE_RELATIONSHIP, this.props.theme))\r\n          .catch(err => {\r\n            console.log(err);\r\n            ShowNotification(NOTIFY.ERROR, this.props.theme);\r\n          });\r\n      };\r\n\r\n      // handles change for any form field, except date & select\r\n      handleChange = (e) => {\r\n        let { name, value } = e.target;\r\n        const activeItem = { ...this.state.activeItem, [name]: value};\r\n        this.setState({ activeItem });\r\n      };\r\n\r\n      // handles change for Date Fields\r\n      handleChangeDate = date => {\r\n        const activeItem = { ...this.state.activeItem, [\"birth_date\"]: moment(date).format('YYYY-MM-DD')};\r\n        this.setState({activeItem});\r\n      };\r\n\r\n      // handles change of file (upload)\r\n      handleChangeFile = (file) => {\r\n        var fileMessage = \"Drag 'n' drop file here, or click to select file\";\r\n\r\n        if(file !== null){\r\n          fileMessage = file.name;\r\n        }\r\n        const activeItem = { ...this.state.activeItem, [\"avatar\"]: file};\r\n        this.setState({activeItem, fileMessage});\r\n      }\r\n\r\n      // handles mode change from Edit to Delete & vice versa\r\n      handleChangeMode = checked => {\r\n        this.setState({ deleteMode: checked }, () => this.downloadTimelineData());\r\n      }\r\n      \r\n      // error handling, validates value in form fields\r\n      validate(form){\r\n        var file_extension_invalid = false;\r\n        if(form.avatar !== null && form.avatar !== undefined && form.avatar.name !== undefined){\r\n          var extensions = ['.bmp', '.cgm', '.gif', '.ico', '.jpeg', '.jpg', '.png', '.ras', '.rgb', '.svg', '.tiff'];\r\n          var file_ext_check = false;\r\n          extensions.map(ext => {\r\n            var file_ext = form.avatar.name.substring(form.avatar.name.lastIndexOf('.'))\r\n            if(ext === file_ext){\r\n              file_ext_check = true;\r\n            }\r\n          })\r\n\r\n          if(!file_ext_check){ file_extension_invalid = true;}\r\n        }\r\n\r\n        return{\r\n          first_name: form.first_name.trim().length === 0,\r\n          first_name_too_long: form.first_name.trim().length > 50,\r\n          last_name: form.last_name.trim().length === 0,\r\n          last_name_too_long: form.last_name.trim().length > 50,\r\n          file_extension: file_extension_invalid,\r\n          birth_place: form.birth_place.trim().length > 50,\r\n        }\r\n      }\r\n\r\n      // error handling\r\n      handleBlur = (field) => (evt) => {\r\n        this.setState({\r\n          touched: { ...this.state.touched, [field]: true },\r\n        });\r\n      }\r\n\r\n      // toggles Milestone modal\r\n      toggleMilestoneModal = () => {\r\n        this.setState({ ModalMilestone: !this.state.ModalMilestone });\r\n      };\r\n\r\n      // toggles Relationship modal\r\n      toggleRelationshipModal = () => {\r\n        this.setState({ ModalRelationship : !this.state.ModalRelationship });\r\n      };\r\n\r\n      render() {\r\n        const { toggle, onSave } = this.props;\r\n        const errors = this.validate(this.state.activeItem);\r\n        const isEnabled = !Object.keys(errors).some(x => errors[x]); // button is disables as long as error exists\r\n        return (\r\n          <React.Fragment>\r\n            <Modal \r\n              className={\"modal-open-\"+this.props.theme}\r\n              isOpen={true} \r\n              toggle={toggle} \r\n              size=\"xl\"\r\n            >\r\n              <ModalHeader className={\"modal-header-\"+this.props.theme} toggle={toggle}> \r\n                Person\r\n                <Form>\r\n                  <Row form>\r\n                    <Col md={4}>\r\n                      <FormGroup>\r\n                        <Label for=\"first_name\">First Name</Label>\r\n                        <Input\r\n                          type=\"text\"\r\n                          name=\"first_name\"\r\n                          className={this.props.theme + ((errors.first_name || errors.first_name_too_long) ? \" error\" : \"\")}\r\n                          onBlur={this.handleBlur('first_name')}\r\n                          value={this.state.activeItem.first_name}\r\n                          onChange={this.handleChange}\r\n                          placeholder=\"First Name\"\r\n                        />\r\n                        {errors.first_name?(<small className={'errortext ' + this.props.theme}>Please insert first name</small>):null}\r\n                        {errors.first_name_too_long?(<small className={'errortext ' + this.props.theme}>This name is too long, max length is 50</small>):null}\r\n                      </FormGroup>\r\n                    </Col>\r\n                    <Col md={4}>\r\n                      <FormGroup>\r\n                        <Label for=\"last_name\">Last Name</Label>\r\n                        <Input\r\n                          type=\"text\"\r\n                          name=\"last_name\"\r\n                          className={this.props.theme + ((errors.last_name || errors.last_name_too_long) ? \" error\" : \"\")}\r\n                          onBlur={this.handleBlur('last_name')}\r\n                          value={this.state.activeItem.last_name}\r\n                          onChange={this.handleChange}\r\n                          placeholder=\"Last Name\"\r\n                        />\r\n                        {errors.last_name?(<small className={'errortext ' + this.props.theme}>Please insert last name</small>):null}\r\n                        {errors.last_name_too_long?(<small className={'errortext ' + this.props.theme}>This name is too long, max length is 50</small>):null}\r\n                      </FormGroup>\r\n                    </Col>\r\n                    <Col md={4}>\r\n                      <FormGroup>\r\n                        <Label for=\"sex_choices\">Sex</Label>\r\n                        <CustomInput \r\n                          id=\"sex_choices\"\r\n                          type=\"select\"\r\n                          className={\"form-control \" + this.props.theme}\r\n                          name = \"sex_choices\"\r\n                          value={this.state.activeItem.sex_choices}\r\n                          onChange={this.handleChange}\r\n                        >\r\n                          <option value=\"male\">Male</option>\r\n                          <option value=\"female\">Female</option>\r\n                          <option value=\"other\">Other</option>\r\n                        </CustomInput>\r\n                      </FormGroup>\r\n                    </Col>\r\n                  </Row>\r\n                  <Row form>\r\n                    <Col md={4}>\r\n                      <FormGroup>\r\n                        <Label for=\"status_choices\">Status of life</Label>\r\n                        <CustomInput \r\n                          id=\"status_choices\"\r\n                          type=\"select\"\r\n                          className={\"form-control \" + this.props.theme}\r\n                          name = \"status_choices\"\r\n                          value={this.state.activeItem.status_choices}\r\n                          onChange={this.handleChange}\r\n                        >\r\n                          <option value=\"living\">Living</option>\r\n                          <option value=\"deceased\">Deceased</option>\r\n                          <option value=\"unknown\">Unknown</option>\r\n                        </CustomInput>\r\n                      </FormGroup>\r\n                    </Col>\r\n                    <Col md={4}>\r\n                      <FormGroup>\r\n                        <Label for=\"birth_date\">Birth Date</Label><br />\r\n                        <DatePicker \r\n                          className={\"form-control \" + this.props.theme}\r\n                          name=\"birth_date\"\r\n                          value={this.state.activeItem.birth_date}\r\n                          onChange={ this.handleChangeDate} \r\n                          peekNextMonth\r\n                          showMonthDropdown\r\n                          showYearDropdown\r\n                          dropdownMode=\"select\"\r\n                        />\r\n                      </FormGroup>\r\n                    </Col>\r\n                    <Col md={4}>\r\n                      <FormGroup>\r\n                        <Label for=\"birth_place\">Birthplace</Label>\r\n                        <Input\r\n                          type=\"text\"\r\n                          className={\"form-control \" + this.props.theme + (errors.birth_place ? \" error\" : \"\")}\r\n                          name=\"birth_place\"\r\n                          value={this.state.activeItem.birth_place}\r\n                          onChange={this.handleChange}\r\n                          placeholder=\"Place of birth\"\r\n                        />\r\n                        {errors.birth_place ? (<small className={'errortext ' + this.props.theme}>This birth place is too long, max length is 50</small>) : null}\r\n                      </FormGroup>\r\n                    </Col>\r\n                  </Row>\r\n                  <Row>\r\n                    <Col>\r\n                    <FormGroup>\r\n                      <Label for=\"avatar\" style={{width: '12.5rem'}}>Change Avatar</Label>\r\n                      <Dropzone \r\n                        onDrop={acceptedFiles => this.handleChangeFile(acceptedFiles[0])}\r\n                        onFileDialogCancel={() => this.handleChangeFile(null)}\r\n                        multiple={false}\r\n                      >\r\n                        {({getRootProps, getInputProps}) => (\r\n                          <section>\r\n                            <div {...getRootProps()} className={\"dropzone \" + this.props.theme + ((errors.file || errors.file_extension) ? \" error\" : \"\")}>\r\n                              <input {...getInputProps()} />\r\n                              <p>{this.state.fileMessage}</p>\r\n                            </div>\r\n                          </section>\r\n                        )}\r\n                      </Dropzone>\r\n                      {errors.file?(<small className={'errortext ' + this.props.theme}>Please upload Image<br/></small>):null}\r\n                      {errors.file_extension?(<small className={'errortext ' + this.props.theme}>This File has unsupported extension. Supported extensions: <b>BMP, CGM, GIF, ICO, JPEG, JPG, PNG, RAS, RGB, SVG, TIFF</b></small>):null}\r\n                    </FormGroup>\r\n                    </Col>\r\n                  </Row>\r\n                  <Row>\r\n                    <Col>\r\n                      <FormGroup style={{display: 'flex'}}>\r\n                        <Label for=\"switch-delete-mode\" style={{marginRight: '10px'}}>Delete Mode</Label>\r\n                        <Switch \r\n                          name=\"switch-delete-mode\" \r\n                          onChange={this.handleChangeMode} \r\n                          checked={this.state.deleteMode} \r\n                        />\r\n                      </FormGroup>\r\n                    </Col>\r\n                    <Col>\r\n                      <Button className=\"confirm\" onClick={() => this.createMilestone()} style={{float: 'right'}}>\r\n                        Add Milestone\r\n                      </Button>\r\n                    </Col>\r\n                  </Row>\r\n                </Form>\r\n              </ModalHeader>\r\n              {this.state.timelineData.length < 1 ? null : \r\n              <ModalBody className={\"modal-body-\"+this.props.theme}>\r\n                <div className=\"personModalTimeline\">\r\n                  <Timeline events={this.state.timelineData} customComponents={{header: CustomHeader, imageBody: CustomImageBody, textBody: CustomTextBody}}/>\r\n                </div>\r\n              </ModalBody>\r\n              }\r\n              <ModalFooter className={\"modal-footer-\"+this.props.theme}>\r\n                <Button disabled={!isEnabled} className=\"confirm\" onClick={() => onSave(this.state.activeItem)}>\r\n                  Save\r\n                </Button>\r\n              </ModalFooter>\r\n            </Modal>\r\n            {this.state.ModalMilestone ? (\r\n              <ModalMilestone\r\n                id={this.props.activeItem.id}\r\n                activeItem={this.state.activeMilestone}\r\n                toggle={this.toggleMilestoneModal}\r\n                onSave={this.handleSubmitMilestone}\r\n                theme={this.props.theme}\r\n              />\r\n            ) : null}\r\n            {this.state.ModalRelationship ? (\r\n              <ModalRelationship\r\n                activeItem={this.state.activeRelationship}\r\n                toggle={this.toggleRelationshipModal}\r\n                onSave={this.handleSubmitRelationship}\r\n                theme={this.props.theme}\r\n              />\r\n            ) : null}\r\n          </React.Fragment>\r\n        );\r\n      }\r\n    }","// frontend/src/Person.js\r\n\r\n    import React, { Component } from \"react\";\r\n    import Draggable from 'react-draggable';\r\n    import ModalPerson from \"./PersonEditTimelineModal\"\r\n    import axios from \"axios\";\r\n    import './Person.css';\r\n    import {NOTIFY} from '../Enums.ts';\r\n    import ShowNotification from '../notification/Notification';\r\n\r\n    class Person extends Component {\r\n      constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n          dragging: false, // flag, which says if user is draggin person or not\r\n         };\r\n      }\r\n\r\n      // toggles the Edit Person Modal\r\n      toggleEditPersonModal = () => {\r\n        this.setState({ modal: !this.state.modal });\r\n      };\r\n\r\n      // handles Person's submission for existing person (changes its data in API)\r\n      handleSubmit = (item) => {\r\n        this.toggleEditPersonModal();\r\n\r\n        if (item.id) {\r\n          var SHA256 = require(\"crypto-js/sha256\");\r\n          var oldItem = this.props.person;\r\n\r\n          let data = new FormData();\r\n          // following conditional instructions are to patch (update) only the data that has been changed, it makes the transfer data lower, especially while having media files\r\n          if(oldItem.user_id !== item.user_id) data.append('user_id', item.user_id);\r\n          if(oldItem.first_name !== item.first_name) data.append('first_name', item.first_name);\r\n          if(oldItem.last_name !== item.last_name) data.append('last_name', item.last_name);\r\n          if(oldItem.birth_date !== item.birth_date) data.append('birth_date', item.birth_date);\r\n          if(oldItem.status_choices !== item.status_choices) data.append('status_choices', item.status_choices);\r\n          if(oldItem.sex_choices !== item.sex_choices) data.append('sex_choices', item.sex_choices);\r\n          if(oldItem.birth_place !== item.birth_place) data.append('birth_place', item.birth_place);\r\n          if(oldItem.relationship_choices !== item.relationship_choices) data.append('relationship_choices', item.relationship_choices);\r\n          if(oldItem.avatar !== item.avatar && item.avatar !== null && item.avatar !== undefined){\r\n            var newFilename = SHA256(Date.now().toString() + item.avatar.name) + item.avatar.name.substring(item.avatar.name.indexOf(\".\"));\r\n            data.append('avatar', item.avatar, newFilename); // sha256 encryption\r\n          } \r\n\r\n          axios\r\n          .patch(`/api/familytreepersons/${item.id}/`, data, {\r\n            headers: {\r\n              'Content-Type': 'multipart/form-data',\r\n              Authorization: `JWT ${localStorage.getItem('token')}`\r\n            }\r\n          })\r\n            .then(() => this.props.refresh())\r\n            .then(() => ShowNotification(NOTIFY.SAVE_PERSON, this.props.theme))\r\n            .catch(err => {\r\n              console.log(err);\r\n              ShowNotification(NOTIFY.ERROR, this.props.theme);\r\n            });\r\n        }\r\n      };\r\n\r\n      // handles deletion of existing Person\r\n      handleDelete = item => {\r\n        this.props.toggleConfirmModal();\r\n        // Django's foreign key & on_delete param handles the deletion of relationships, so it's no longer needed to do this manually\r\n        // Same with Milestones, deleting person means deleting its ID from Person & Milestone relation-table\r\n        axios\r\n          .delete(`/api/familytreepersons/${item.id}`, {\r\n            headers: { Authorization: `JWT ${localStorage.getItem('token')}`}\r\n          })\r\n          .then(() => this.props.refresh())\r\n          .then(() => this.props.refreshRelationships())\r\n          .then(() => ShowNotification(NOTIFY.DELETE_PERSON, this.props.theme))\r\n          .catch(err => {\r\n            console.log(err);\r\n            ShowNotification(NOTIFY.ERROR, this.props.theme);\r\n          });\r\n      };\r\n\r\n      // handles click on existing Person (tells if user wants to drag a person or no)\r\n      handleClick = e => {\r\n        if(e.type === \"mousedown\"){\r\n          this.setState({\r\n            dragging: true\r\n          })\r\n        }\r\n        else{\r\n          this.setState({\r\n            dragging: false\r\n          })\r\n        }\r\n      }\r\n\r\n      // handles person movement; updates coords & relationships only when person container is moving (react can't decide because of changing CSS Transform values, not states)\r\n      handleMovement(){\r\n        if(this.state.dragging){\r\n          this.props.getCoordinates()\r\n          this.props.renderRelationships()\r\n        }\r\n      }\r\n\r\n      getRelativePath(mediaFile){\r\n        return mediaFile.substring(mediaFile.indexOf('/media'))\r\n      }\r\n\r\n      render() {\r\n        // free movement -> delete grid from handlers\r\n        const dragHandlers = {onStart: this.onStart, onStop: this.onStop, grid: [1, 1]};\r\n        return (\r\n          <React.Fragment>\r\n            <Draggable \r\n              cancel=\"button\" {...dragHandlers} \r\n              key={this.props.person.id}\r\n              defaultPosition={{x: 0, y: 0}}\r\n            >\r\n              <div \r\n              className=\"personcontainer\"\r\n              >\r\n                <div\r\n                  id={this.props.person.id}\r\n                  className={\"person id_\" + this.props.person.id + \" \" + (this.props.activePersons.includes(this.props.person.id)?\"active\":\"inactive\") +  \" border rounded \" + this.props.theme}\r\n                  onDoubleClick={() => this.props.setActivePerson(this.props.person.id)}\r\n                  onMouseDown={this.handleClick.bind(this)}\r\n                  onMouseUp={this.handleClick.bind(this)}\r\n                  onMouseMove={this.handleMovement.bind(this)}\r\n                >\r\n                  <img src={this.getRelativePath(this.props.person.avatar)}\r\n                  draggable=\"false\"\r\n                  className = \"img-thumbnail\"\r\n                  alt = \"Error: not found\"/>\r\n                  <div\r\n                    className={`name`}\r\n                    first_name={this.props.person.first_name}\r\n                  >\r\n                    {this.props.person.first_name + ' ' + this.props.person.last_name}\r\n                  </div>\r\n                  {this.props.printable ? null :(\r\n                  <div>\r\n                    <button\r\n                      onClick={() => this.toggleEditPersonModal()}\r\n                      className={\"btn \" + (this.props.theme === 'dark' ? 'dark btn-outline-' : 'light btn-') + \"primary btn-xl personbutton\"}\r\n                    >\r\n                      <i className=\"fas fa-user-edit\"></i>\r\n                    </button>\r\n                    <button\r\n                      onClick={() => this.props.toggleConfirmModal(\"Delete Person\", \"Are you sure you want to delete \" + this.props.person.first_name + \" \" + this.props.person.last_name + \" with connected relationships from Familytree?\", \"Delete\", \"Cancel\", () => this.handleDelete(this.props.person))}\r\n                      className={\"btn \" + (this.props.theme === 'dark' ? 'dark btn-outline-' : 'light btn-') + \"primary btn-xl personbutton\"}\r\n                    >\r\n                      <i className=\"fas fa-user-minus\"></i>\r\n                    </button>\r\n                  </div>\r\n                  )} \r\n                </div>\r\n              </div>\r\n            </Draggable>\r\n            {this.state.modal ? (\r\n              <ModalPerson\r\n                activeItem={this.props.person}\r\n                toggle={this.toggleEditPersonModal}\r\n                onSave={this.handleSubmit}\r\n                refreshRelationships={this.props.refreshRelationships.bind(this)}\r\n                toggleConfirmModal={this.props.toggleConfirmModal.bind(this)}\r\n                theme={this.props.theme}\r\n              />\r\n            ) : null}\r\n          </React.Fragment>\r\n        );\r\n      }\r\n    }\r\n    export default Person;","// frontend/src/Relationship.js\r\n/*eslint array-callback-return: 0*/\r\n\r\n    import React, { Component } from \"react\";\r\n    import { Tooltip } from 'react-svg-tooltip';\r\n\r\n    class Relationship extends Component {\r\n      constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n          relationshipMarker: [],\r\n          relationship: [],\r\n          personSize: this.props.personSize,\r\n         };\r\n      }\r\n\r\n      componentDidMount(){\r\n        this.renderRelationship();\r\n      }\r\n\r\n      // calculate side centers w/ direction for 2 given person containers\r\n      calcSideCenters(first, second){\r\n        var nav;\r\n        if(document.getElementById(\"nav\") !== null){\r\n          nav = document.getElementById(\"nav\").getBoundingClientRect().height - 5; // get height of nav bar\r\n        }\r\n        else{\r\n          nav = 30;\r\n        }\r\n\r\n        var relationshipPoints = { // contains side centers for 2 give person containers\r\n          top: [\r\n            {x: first.screen.x + this.state.personSize.width / 2, y: first.screen.y},\r\n            {x: second.screen.x + this.state.personSize.width / 2, y: second.screen.y}\r\n          ],\r\n          right: [\r\n            {x: first.screen.x + this.state.personSize.width, y: first.screen.y + this.state.personSize.height / 2},\r\n            {x: second.screen.x + this.state.personSize.width, y: second.screen.y + this.state.personSize.height / 2}\r\n          ],\r\n          bottom: [\r\n            {x: first.screen.x + this.state.personSize.width / 2, y: first.screen.y + this.state.personSize.height},\r\n            {x: second.screen.x + this.state.personSize.width / 2, y: second.screen.y + this.state.personSize.height}\r\n          ],\r\n          left: [\r\n            {x: first.screen.x, y: first.screen.y + this.state.personSize.height / 2},\r\n            {x: second.screen.x, y: second.screen.y + this.state.personSize.height / 2}\r\n          ],\r\n          mid: [\r\n            {x: first.screen.x + this.state.personSize.width / 2, y: first.screen.y + this.state.personSize.height / 2},\r\n            {x: second.screen.x + this.state.personSize.width / 2, y:second.screen.y + this.state.personSize.height / 2}\r\n          ],\r\n        };\r\n\r\n        var x1Temp, y1Temp, x2Temp, y2Temp;\r\n        var horizontalTemp = false;\r\n\r\n        // if first person is under second person\r\n        if(relationshipPoints.top[0].y > relationshipPoints.bottom[1].y + 10){\r\n          x1Temp = relationshipPoints.top[0].x + 5;\r\n          y1Temp = relationshipPoints.top[0].y + nav + 10;\r\n          x2Temp = relationshipPoints.bottom[1].x + 5;\r\n          y2Temp = relationshipPoints.bottom[1].y + nav + 20;\r\n        }\r\n        // if first person is above second person\r\n        else if(relationshipPoints.bottom[0].y < relationshipPoints.top[1].y - 10){\r\n          x1Temp = relationshipPoints.bottom[0].x + 5;\r\n          y1Temp = relationshipPoints.bottom[0].y + nav + 5;\r\n          x2Temp = relationshipPoints.top[1].x + 5;\r\n          y2Temp = relationshipPoints.top[1].y + nav;\r\n        }\r\n        // if first person is on the left of second person\r\n        else if(relationshipPoints.right[0].x < relationshipPoints.left[1].x){\r\n          x1Temp = relationshipPoints.right[0].x + 5;\r\n          y1Temp = relationshipPoints.right[0].y + nav + 5;\r\n          x2Temp = relationshipPoints.left[1].x + 5;\r\n          y2Temp = relationshipPoints.left[1].y + nav + 5;\r\n          horizontalTemp = true;\r\n        }\r\n        // if first person is on the right of second person\r\n        else if(relationshipPoints.left[0].x > relationshipPoints.right[1].x){\r\n          x1Temp = relationshipPoints.left[0].x + 5;\r\n          y1Temp = relationshipPoints.left[0].y + nav + 5;\r\n          x2Temp = relationshipPoints.right[1].x + 5;\r\n          y2Temp = relationshipPoints.right[1].y + nav + 5;\r\n          horizontalTemp = true;\r\n        }\r\n        // if first person is on second person and vice versa\r\n        else{\r\n          x1Temp = relationshipPoints.mid[0].x;\r\n          y1Temp = relationshipPoints.mid[0].y;\r\n          x2Temp = relationshipPoints.mid[0].x;\r\n          y2Temp = relationshipPoints.mid[0].y;\r\n        }\r\n\r\n        return {x1: x1Temp, y1: y1Temp, x2: x2Temp, y2: y2Temp, horizontal: horizontalTemp};\r\n      }\r\n\r\n      // renders given relationship\r\n      renderRelationship(){\r\n        var relationshipPairList = [];\r\n        var first, second;\r\n\r\n        if(this.props.personCoordinates === undefined){\r\n          first = second =  {id: 2137, screen: {x: 0, y: 0}}\r\n        }\r\n        else{\r\n          first = (this.props.personCoordinates.filter(el => parseInt(el.id) === parseInt(this.props.relationship.id_1)))[0]; // get 1st person coordinates\r\n          second =(this.props.personCoordinates.filter(el => parseInt(el.id) === parseInt(this.props.relationship.id_2)))[0];// get 2nd person coordinates\r\n        }\r\n\r\n        var sideCoords = this.calcSideCenters(first, second); // calculate proper side coords for this pair of persons\r\n\r\n        // connection between persons has sharp edges, so you need 4 coords; it support horizontal positioning as well\r\n        var pointsTemp = Math.round(sideCoords.x1) + \" \" + Math.round(sideCoords.y1) +\r\n        \", \" + Math.round(sideCoords.x1) + \" \" + Math.round((Math.round(sideCoords.y1) + Math.round(sideCoords.y2))/2) +\r\n        \", \" + Math.round(sideCoords.x2) + \" \" + Math.round((Math.round(sideCoords.y1) + Math.round(sideCoords.y2))/2) +\r\n        \", \" + Math.round(sideCoords.x2) + \" \" + Math.round(sideCoords.y2)\r\n\r\n        if(sideCoords.horizontal){\r\n          pointsTemp = Math.round(sideCoords.x1) + \" \" + Math.round(sideCoords.y1) +\r\n          \", \" + Math.round((Math.round(sideCoords.x1) + Math.round(sideCoords.x2))/2) + \" \" + Math.round(sideCoords.y1) +\r\n          \", \" + Math.round((Math.round(sideCoords.x1) + Math.round(sideCoords.x2))/2) + \" \" + Math.round(sideCoords.y2) +\r\n          \", \" + Math.round(sideCoords.x2) + \" \" + Math.round(sideCoords.y2);\r\n        }\r\n\r\n        relationshipPairList.push({ \r\n          id: this.props.relationship.id,\r\n          relationship: this.props.relationship.relationships,\r\n          id1: first.id, id2: second.id, \r\n          color: this.props.relationship.color,\r\n          points: pointsTemp,\r\n          horizontal: sideCoords.horizontal,\r\n          descendant: this.props.relationship.descendant,\r\n        });\r\n\r\n        var reference = React.createRef(); // reference to relationship for Toolitp (relationship name on hover)\r\n\r\n        this.setState({\r\n          relationshipMarker: (relationshipPairList.map(item => ( // marker - arrow at the end of relationship\r\n            item.descendant ? (\r\n              <marker \r\n                id={'head_' + item.color.substring(1)} \r\n                key={'head_' + item.color.substring(1)} \r\n                orient=\"auto\"\r\n                markerWidth='6' markerHeight='6'\r\n                refX={item.horizontal ? '3.2' : '0.1'} refY='3'\r\n              >\r\n                <path d='M0,0 V6 L3,3 Z' fill={item.color} stroke={item.color}/>\r\n              </marker>\r\n            ) : null\r\n          ))),\r\n          relationship: (relationshipPairList.map(item => ( // relationship\r\n            <React.Fragment\r\n            key={\"fragment_\" + item.id1 + \"_\" + item.id2}\r\n            >\r\n              <polyline \r\n              ref={reference}\r\n              id={\"path_\" + item.id1 + \"_\" + item.id2}\r\n              markerEnd={'url(#head_' + item.color.substring(1) + ')'}\r\n              points={item.points} \r\n              stroke = {item.color}\r\n              strokeWidth=\"3\" \r\n              fill=\"none\"/>\r\n              {/* Relationship name on connection hover */}\r\n              <Tooltip triggerRef={reference}>\r\n                  <rect x={0} y={-35} width={this.calcTextWidth(item.relationship, \"16pt arial\") + 29} height={35} rx={5} ry={5} fill='black'/>\r\n                  <text x={15} y={-10} fontSize={\"16pt\"} fill='white'>{item.relationship}</text>\r\n              </Tooltip>\r\n            </React.Fragment>\r\n            )\r\n          )\r\n        )});\r\n      }\r\n\r\n      // calculate the text width for Tooltip Component, by using text length (relationship name on hover)\r\n      calcTextWidth(text, font) {\r\n        try{\r\n          var canvas = this.calcTextWidth.canvas || (this.calcTextWidth.canvas = document.createElement(\"canvas\"));\r\n          var context = canvas.getContext(\"2d\");\r\n          context.font = font;\r\n          var metrics = context.measureText(text);\r\n          return metrics.width;\r\n        }\r\n        catch(TypeError){\r\n          return 30;\r\n        }\r\n      }      \r\n\r\n      render() {\r\n        return (\r\n          <React.Fragment>\r\n            <defs>\r\n              {this.state.relationshipMarker}\r\n            </defs>\r\n            {this.state.relationship}\r\n          </React.Fragment>\r\n        );\r\n      }\r\n    }\r\n    export default Relationship;","// frontend/src/components/PersonAddModal.js\r\n/*eslint no-useless-computed-key: 0*/\r\n/*eslint array-callback-return: 0*/\r\n\r\n    import React, { Component } from \"react\";\r\n    import DatePicker from \"react-datepicker\";\r\n    import 'react-datepicker/dist/react-datepicker.css';\r\n    import '../Modal.css';\r\n    import moment from 'moment'\r\n    import Dropzone from 'react-dropzone'\r\n\r\n    import {\r\n      Button,\r\n      CustomInput,\r\n      Modal,\r\n      ModalHeader,\r\n      ModalBody,\r\n      ModalFooter,\r\n      Form,\r\n      FormGroup,\r\n      Input,\r\n      Label,\r\n    } from \"reactstrap\";\r\n\r\n    export default class CustomModal extends Component {\r\n      constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n          activeItem: this.props.activeItem,\r\n          fileMessage: \"Drag 'n' drop file here, or click to select file\",\r\n        };\r\n      }\r\n\r\n      // handles change of all fields, except date, file & select\r\n      handleChange = (e) => {\r\n        let { name, value } = e.target;\r\n        const activeItem = { ...this.state.activeItem, [name]: value};\r\n        this.setState({ activeItem });\r\n      };\r\n\r\n      // handles change of Date Field\r\n      handleChangeDate = date => {\r\n        const activeItem = { ...this.state.activeItem, [\"birth_date\"]: moment(date).format('YYYY-MM-DD')};\r\n        this.setState({activeItem});\r\n      };\r\n\r\n      // handles change of File Field (upload)\r\n      handleChangeFile = (file) => {\r\n        var fileMessage = \"Drag 'n' drop file here, or click to select file\";\r\n\r\n        if(file !== null){\r\n          fileMessage = file.name;\r\n        }\r\n\r\n        const activeItem = { ...this.state.activeItem, [\"avatar\"]: file};\r\n        this.setState({activeItem, fileMessage});\r\n      }\r\n\r\n      // error handling, validates given form fields\r\n      validate(form){\r\n        var extensions = ['.bmp', '.cgm', '.gif', '.ico', '.jpeg', '.jpg', '.png', '.ras', '.rgb', '.svg', '.tiff']\r\n        var file_extension_invalid = true\r\n        if(form.avatar !== null && form.avatar !== undefined){\r\n          extensions.map(ext => {\r\n            var file_ext = form.avatar.name.substring(form.avatar.name.lastIndexOf('.'))\r\n            if(ext === file_ext){\r\n              file_extension_invalid = false;\r\n            }\r\n          })\r\n        }\r\n        return{\r\n          first_name: form.first_name.trim().length === 0,\r\n          first_name_too_long: form.first_name.trim().length > 50,\r\n          last_name: form.last_name.trim().length === 0,\r\n          last_name_too_long: form.last_name.trim().length > 50,\r\n          file: form.avatar === null || form.avatar === undefined,\r\n          file_extension: file_extension_invalid,\r\n          birth_place: form.birth_place.trim().length > 50,\r\n        }\r\n      }\r\n      \r\n      render() {\r\n        const { toggle, onSave } = this.props;\r\n        const errors = this.validate(this.state.activeItem);\r\n        const isEnabled = !Object.keys(errors).some(x => errors[x]); // button is disabled as long as error exists\r\n        return (\r\n          <Modal className={\"modal-open-\"+this.props.theme} isOpen={true} toggle={toggle}>\r\n            <ModalHeader className={\"modal-header-\"+this.props.theme} toggle={toggle}> Person </ModalHeader>\r\n            <ModalBody className={\"modal-body-\"+this.props.theme}>\r\n              <Form>\r\n              <FormGroup>\r\n                  <Label for=\"first_name\">First Name</Label>\r\n                  <Input\r\n                    type=\"text\"\r\n                    name=\"first_name\"\r\n                    className={this.props.theme + ((errors.first_name || errors.first_name_too_long) ? \" error\" : \"\")}\r\n                    value={this.state.activeItem.first_name}\r\n                    onChange={this.handleChange}\r\n                    placeholder=\"First Name\"\r\n                    \r\n                  />\r\n                  {errors.first_name?(<small className={'errortext ' + this.props.theme}>Please insert first name</small>):null}\r\n                  {errors.first_name_too_long?(<small className={'errortext ' + this.props.theme}>This name is too long, max length is 50</small>):null}\r\n                </FormGroup>\r\n                <FormGroup>\r\n                  <Label for=\"last_name\">Last Name</Label>\r\n                  <Input\r\n                    type=\"text\"\r\n                    name=\"last_name\"\r\n                    className={this.props.theme + ((errors.last_name || errors.last_name_too_long) ? \" error\" : \"\")}\r\n                    value={this.state.activeItem.last_name}\r\n                    onChange={this.handleChange}\r\n                    placeholder=\"Last Name\"\r\n                  />\r\n                  {errors.last_name?(<small className={'errortext ' + this.props.theme}>Please insert last name</small>):null}\r\n                  {errors.last_name_too_long?(<small className={'errortext ' + this.props.theme}>This name is too long, max length is 50</small>):null}\r\n                </FormGroup>\r\n                <FormGroup>\r\n                  <Label for=\"birth_date\">Birth Date</Label><br />\r\n                  <DatePicker \r\n                    className={\"form-control \" + this.props.theme}\r\n                    name=\"birth_date\"\r\n                    value={this.state.activeItem.birth_date}\r\n                    onChange={ this.handleChangeDate} \r\n                    peekNextMonth\r\n                    showMonthDropdown\r\n                    showYearDropdown\r\n                    dropdownMode=\"select\"/>\r\n                </FormGroup>\r\n                <FormGroup>\r\n                  <Label for=\"status_choices\">Status of life</Label>\r\n                  <CustomInput \r\n                    id=\"status_choices\"\r\n                    type=\"select\"\r\n                    className={\"form-control \" + this.props.theme}\r\n                    name = \"status_choices\"\r\n                    value={this.state.activeItem.status_choices}\r\n                    onChange={this.handleChange}\r\n                  >\r\n                    <option value=\"living\">Living</option>\r\n                    <option value=\"deceased\">Deceased</option>\r\n                    <option value=\"unknown\">Unknown</option>\r\n                  </CustomInput>\r\n                </FormGroup>\r\n                <FormGroup>\r\n                  <Label for=\"sex_choices\">Sex</Label>\r\n                  <CustomInput \r\n                    id=\"sex_choices\"\r\n                    type=\"select\"\r\n                    className={\"form-control \" + this.props.theme}\r\n                    name = \"sex_choices\"\r\n                    value={this.state.activeItem.sex_choices}\r\n                    onChange={this.handleChange}\r\n                  >\r\n                    <option value=\"male\">Male</option>\r\n                    <option value=\"female\">Female</option>\r\n                    <option value=\"other\">Other</option>\r\n                  </CustomInput>\r\n                </FormGroup>\r\n                <FormGroup>\r\n                  <Label for=\"birth_place\">Birthplace</Label>\r\n                  <Input\r\n                    type=\"text\"\r\n                    name=\"birth_place\"\r\n                    className={\"form-control \" + this.props.theme + (errors.birth_place ? \" error\" : \"\")}\r\n                    value={this.state.activeItem.birth_place}\r\n                    onChange={this.handleChange}\r\n                    placeholder=\"Place of birth\"\r\n                  />\r\n                  {errors.birth_place?(<small className={'errortext ' + this.props.theme}>This birth place is too long, max length is 50</small>):null}\r\n                </FormGroup>\r\n                <FormGroup>\r\n                  <Label for=\"avatar\">Avatar</Label>\r\n                  <Dropzone \r\n                    onDrop={acceptedFiles => this.handleChangeFile(acceptedFiles[0])}\r\n                    onFileDialogCancel={() => this.handleChangeFile(null)}\r\n                    multiple={false}\r\n                  >\r\n                    {({getRootProps, getInputProps}) => (\r\n                      <section>\r\n                        <div {...getRootProps()} className={\"dropzone \" + this.props.theme + ((errors.file || errors.file_extension) ? \" error\" : \"\")}>\r\n                          <input {...getInputProps()} />\r\n                          <p>{this.state.fileMessage}</p>\r\n                        </div>\r\n                      </section>\r\n                    )}\r\n                  </Dropzone>\r\n                  {errors.file?(<small className={'errortext ' + this.props.theme}>Please upload Image<br/></small>):null}\r\n                  {errors.file_extension?(<small className={'errortext ' + this.props.theme}>This File has unsupported extension. Supported extensions: <b>BMP, CGM, GIF, ICO, JPEG, JPG, PNG, RAS, RGB, SVG, TIFF</b></small>):null}\r\n                </FormGroup>\r\n              </Form>\r\n            </ModalBody>\r\n            <ModalFooter className={\"modal-footer-\"+this.props.theme}>\r\n              <Button disabled={!isEnabled} className=\"confirm\" onClick={() => onSave(this.state.activeItem)}>\r\n                Save\r\n              </Button>\r\n            </ModalFooter>\r\n          </Modal>\r\n        );\r\n      }\r\n    }","// frontend/src/components/FirstTimeModal.js\r\n/*eslint no-useless-computed-key: 0*/\r\n\r\n    import React, { Component } from \"react\";\r\n    import './FirstTime.css';\r\n    import '../Modal.css';\r\n    \r\n    import {\r\n      Button,\r\n      Modal,\r\n      ModalHeader,\r\n      ModalBody,\r\n      ModalFooter,\r\n    } from \"reactstrap\";\r\n\r\n    export default class CustomModal extends Component {\r\n      constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n          activeItem: this.props.activeItem,\r\n          touched: {\r\n            first_name: false,\r\n            last_name: false,\r\n          },\r\n        };\r\n      }\r\n      \r\n      render() {\r\n        const { toggle, onSave } = this.props;\r\n        return (\r\n          <Modal className={\"modal-open-\"+this.props.theme} isOpen={true} toggle={toggle} size=\"lg\">\r\n            <ModalHeader className={\"modal-header-\"+this.props.theme} toggle={toggle}> Welcome to the Familytree website! </ModalHeader>\r\n            <ModalBody className={\"first-time-body modal-body-\"+this.props.theme}>\r\n              We are really proud you did create an account. You'll see this message everytime you log-in/refresh page for 24hrs since account registration. Please, let us introduce our website.<br/><br/>\r\n              \r\n              <hr className={\"hr-body \" + this.props.theme}/> <br/>\r\n              \r\n              <h1 className={\"header \" + this.props.theme}>Student Project</h1> <br/>\r\n              You need to know that this is a student project and we <b>DO NOT</b> carry responsibility for <b>ANY data leaks</b>. This project is not meant to be used in Production. <br/><br/>\r\n              \r\n              <hr className={\"hr-body \" + this.props.theme}/> <br/>\r\n              \r\n              <h1 className={\"header \" + this.props.theme}>Main functionality</h1> <br/>\r\n              In this app, you can create your own Familytree with proper relations between certain people. Background serves as a board, which means you can move every person in whatever direction you want. Additionally, every person has its own Timeline, where you can see previously added Relationships AND Milestones (that's how we call every 'big event' in your life, i.e. move to other city, promotion). To every relationship/milestone, you can add image/movie. In addition, every person has its own avatar (you can call it profile photo).<br/><br/>\r\n              \r\n              <hr className={\"hr-body \" + this.props.theme}/> <br/>\r\n              \r\n              <h1 className={\"header \" + this.props.theme}>Buttons</h1> <br/>\r\n              At the bottom of this page, you can see few buttons. Now we'll try to explain what every single button does.\r\n              <ul className=\"first-time-list\">\r\n                <li><b>Download (white)</b> - downloads actually existing familytree to the PDF format</li>\r\n                <li><b>Delete (red, X)</b> - deletes your whole familytree. Of course it asks before doing this</li>\r\n                <li><b>Reset (yellow, undo)</b> - resets the position of every person to the initial ones</li>\r\n                <li><b>Save (blue, floppy drive)</b> - saves actual coordinates of every person and makes it the initial values</li>\r\n                <li><b>Add (green, plus)</b> - opens the \"Add Person\" modal, that's where you can add new people to the familytree</li>\r\n              </ul>\r\n              Each person has their own individual buttons.\r\n              <ul className=\"first-time-list\">\r\n                <li><b>Edit (blue, person with pencil)</b> - opens the \"Edit Person\" modal, where you can edit info about specific human-being, see Timeline, add new Milestones to the Timeline and edit/delete relationships/milestones</li>\r\n                <li><b>Delete (dark, person with minus)</b> - deletes person with its connections (relations)</li>\r\n              </ul><br/>\r\n              \r\n              <hr className={\"hr-body \" + this.props.theme}/> <br/>\r\n              \r\n              <h1 className={\"header \" + this.props.theme}>Connection between two people</h1> <br/>\r\n              In order to add any connection between two chosen people, you need to double-click them. If it's a 2-level relation (i.e. child), then you need to double-click on Parent first, then on Child. If any person is already 'active' (double-clicked, chosen), then it has border in different color than 'inactive' person. Worth mentioning: <b>Every pair can have more than one connection between them, but only the newest one (or the one still ongoin) will be visible for user.</b><br/><br/>\r\n              \r\n              <hr className={\"hr-body \" + this.props.theme}/> <br/>\r\n\r\n              <h1 className={\"header \" + this.props.theme}>Timeline</h1> <br/>\r\n              As previously mentioned, our project has a timeline functionality. Because we wanted to make it useful, every person has its own timeline. In order to open it, you just need to click the <b>Edit button (blue, person with pencil)</b> located at the bottom of Person's card. Our timeline can store 2 different types of posts:\r\n              <ul className=\"first-time-list\">\r\n                <li><b>Milestone</b> - from the <b>Edit Person</b> window, you can Add, Edit & Delete Milestone. If you want to add post of this type, you just need to click on green button named \"Add Milestone\". In order to edit this, you need to be sure that Delete Mode is disabled (the only one visible toggle button), then go to specific Milestone and click the big \"Edit Milestone\" button. It is worth mentioning that for this type of timeline post, it's required to add your own file. This file needs to be a media type, which means Video or Image. Plus, there <b>always</b> needs to be at least one person connected with specific milestone. After adding at least 2 people, you'll see additional message after description, which says with who you spent this time.</li>\r\n                <li><b>Relationship</b> - you can only edit or delete relationship, you can't add it here. In order to add relationship, go back to <b>Connection between two people</b> part. Relationship doesn't have any media, it has only a default image we set. Because of that loss, we decided to add few more things that are not in <b>Milestones</b>\r\n                  <ul className=\"first-time-list\">\r\n                    <li><b>End Date</b> - if your relation with someone has changed, you don't need to edit its type. You can add new relation with new type, and then edit the old one and set End date.</li>\r\n                    <li><b>Type</b> - every relation in Timeline has its own relation type written under description, which helps to recognize relation even when you can't recognize relation from title & description</li>\r\n                    <li><b>Together with</b> - in this line, under description and previously mentioned options, you'll see first & last name of person who is with you in specific relation.</li>\r\n                  </ul>\r\n                </li>\r\n              </ul>\r\n              <br />\r\n\r\n              <hr className={\"hr-body \" + this.props.theme}/> <br/>\r\n\r\n              <h1 className={\"header \" + this.props.theme}>Final Speech</h1> <br/>\r\n              We tried to describe as many not-so-common functionalities as possible. If you find something hard to understand, please feel free to contact us <b>(if only it was in production, there would be an e-mail address)</b>. It is really early stage of the project, so if you find some bugs or you'll see error you can't understand and/or resolve, please, let us know. We are unable to test everything, unfortunately.\r\n              <br /><br />\r\n              <b>CAUTION: </b> We want to remind you that it's a student's project, so it's not meant to be in production. Any data leaks, bugs & shortcomings are possible and we are really sorry for them to occur.\r\n            </ModalBody>\r\n            <ModalFooter className={\"modal-footer-\"+this.props.theme}>\r\n              <Button className=\"confirm\" onClick={() => onSave()}>\r\n                I understand\r\n              </Button>\r\n            </ModalFooter>\r\n          </Modal>\r\n        );\r\n      }\r\n    }","// frontend/src/components/ConfirmationModal.js\r\n/*eslint no-useless-computed-key: 0*/\r\n\r\n    import React, { Component } from \"react\";\r\n    import './Modal.css'\r\n    import {\r\n      Button,\r\n      Modal,\r\n      ModalHeader,\r\n      ModalBody,\r\n      ModalFooter,\r\n    } from \"reactstrap\";\r\n\r\n    export default class CustomModal extends Component {\r\n      constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n          header: this.props.header,\r\n          content: this.props.content,\r\n          confirmText: this.props.confirmText,\r\n          cancelText: this.props.cancelText,\r\n        };\r\n      }\r\n      \r\n      render() {\r\n        const { toggle, onConfirm } = this.props;\r\n        return (\r\n          <Modal className={\"modal-open-\"+this.props.theme} isOpen={true} toggle={toggle}>\r\n            <ModalHeader className={\"modal-header-\"+this.props.theme} toggle={toggle}> \r\n              {this.state.header} \r\n            </ModalHeader>\r\n            <ModalBody className={\"modal-body-\"+this.props.theme}> \r\n              {this.state.content} \r\n            </ModalBody>\r\n            <ModalFooter className={\"modal-footer-\"+this.props.theme}>\r\n              <Button onClick={toggle}>\r\n                {this.state.cancelText}\r\n              </Button>\r\n              <Button className=\"confirm\" onClick={() => onConfirm()}>\r\n                {this.state.confirmText}\r\n              </Button>\r\n            </ModalFooter>\r\n          </Modal>\r\n        );\r\n      }\r\n    }","// frontend/src/Familytree.js\r\n/*eslint no-useless-computed-key: 0*/\r\n/*eslint array-callback-return: 0*/\r\n\r\n    import React, { Component } from \"react\";\r\n    import axios from \"axios\";\r\n    import Person from \"./components/person/Person\";\r\n    import Relationship from \"./components/relationship/Relationship\"\r\n    import ModalRelationship from \"./components/relationship/RelationshipModal\";\r\n    import ModalPerson from \"./components/person/PersonAddModal\";\r\n    import ModalFirstTime from './components/auth/FirstTimeModal';\r\n    import {NOTIFY} from './components/Enums.ts';\r\n    import ShowNotification from './components/notification/Notification';\r\n    import './Familytree.css';\r\n    import ModalConfirm from './components/ConfirmationModal'\r\n\r\n    class Familytree extends Component {    \r\n      constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n          windowSize: {width: 0, height: 0}, // size of the window\r\n          saving: false, // flag, if it's saving coordinates\r\n          printable: false,\r\n\r\n          personList: this.props.personList, // list of persons\r\n          personCoordinates: [], // list of person's coordinates\r\n          personSize: [], // size of person's container (to calculate middle)\r\n          activePersonData: [], // data for creating new Person\r\n          activePersonIDList: [], // list of active persons (double-clicked)\r\n\r\n          relationshipList: this.props.relationshipList, // list of relationships\r\n          activeRelationshipData: [], // relationship\r\n\r\n          activeConfirmData: [],\r\n        };\r\n        this.updateWindowDimensions = this.updateWindowDimensions.bind(this);\r\n      }  \r\n\r\n      componentDidMount(){\r\n        this.checkNewUserStatus();\r\n        this.updateWindowDimensions();\r\n        window.addEventListener('resize', this.updateWindowDimensions);\r\n      }\r\n\r\n      componentWillUnmount() {\r\n        window.removeEventListener('resize', this.updateWindowDimensions);\r\n      }\r\n\r\n      checkNewUserStatus(){\r\n        var registerDate = new Date(localStorage.getItem('date_joined'));\r\n        if(Date.now() - registerDate <= 86400000){ // 24hrs period since account registration\r\n          this.toggleFirstTimeModal();\r\n        }\r\n      }\r\n\r\n      updateWindowDimensions() {\r\n        var winSize = {width: window.innerWidth, height: window.innerHeight}\r\n        this.setState({ windowSize: winSize }, () => this.getCoordinates());\r\n      }\r\n\r\n      // refreshes persons list and then gets their coords\r\n      refreshPersonList = () => {\r\n        axios\r\n          .get(\"/api/familytreepersons/\", {\r\n            headers: { Authorization: `JWT ${localStorage.getItem('token')}`}\r\n          })\r\n          .then(res => this.setState({ personList: res.data }))\r\n          .then(() => this.getCoordinates())\r\n          .catch(err => {\r\n            console.log(err);\r\n            ShowNotification(NOTIFY.ERROR, this.props.theme);\r\n          });\r\n      };\r\n\r\n      // refreshes relationships list\r\n      refreshRelationshipList = () => {\r\n        axios\r\n          .get(\"/api/familytreerelationship/\", {\r\n            headers: { Authorization: `JWT ${localStorage.getItem('token')}`}\r\n          })\r\n          .then(res => this.setState({ relationshipList: res.data }))\r\n          .then(() => this.renderRelationships())\r\n          .catch(err => {\r\n            console.log(err);\r\n            ShowNotification(NOTIFY.ERROR, this.props.theme);\r\n          });\r\n      };\r\n\r\n      toggleFirstTimeModal = () => {\r\n        this.setState({ ModalFirstTime: !this.state.ModalFirstTime });\r\n      }\r\n\r\n      toggleConfirmModal = (header=\"\", content=\"\", confirmText=\"\", cancelText=\"\", onConfirm=() => this.toggleConfirmModal) => {\r\n        this.setState({\r\n          activeConfirmData: {\r\n            header: header,\r\n            content: content,\r\n            confirmText: confirmText,\r\n            cancelText: cancelText,\r\n            onConfirm: onConfirm,\r\n          },\r\n          ModalConfirm: !this.state.ModalConfirm,\r\n        });\r\n      }\r\n      \r\n      // toggles Person Add modal\r\n      togglePersonModal = () => {\r\n        this.setState({ modal: !this.state.modal });\r\n      };\r\n\r\n      // toggles Relationship Add modal\r\n      toggleRelationshipModal = () => {\r\n        this.setState({ activeRelationshipData: {\r\n          user_id: localStorage.getItem('user_id'),\r\n          id_1: this.state.activePersonIDList[0], // 1st active person\r\n          id_2: this.state.activePersonIDList[1], // 2nd active person\r\n          color: \"\",\r\n          title: \"\",\r\n          description: \"\",\r\n          begin_date: \"\",\r\n          end_date: null,\r\n          descendant: false, // flag, if it's a 2-level relationship\r\n          relationships: 'married', // default value for select\r\n        },\r\n        ModalRelationship: !this.state.ModalRelationship });\r\n      };\r\n\r\n      // handles new Person submission\r\n      handleSubmitPerson = (item) => {\r\n        this.togglePersonModal();\r\n        var SHA256 = require(\"crypto-js/sha256\"); // SHA256 encryption\r\n        var newFilename = SHA256(Date.now().toString() + item.avatar.name) + item.avatar.name.substring(item.avatar.name.indexOf(\".\")); // encrypted avatar's filename\r\n\r\n        let data = new FormData(); // creates a data based on form, w/ values mentioned below\r\n        data.append('user_id', item.user_id);\r\n        data.append('first_name', item.first_name);\r\n        data.append('last_name', item.last_name);\r\n        data.append('birth_date', item.birth_date);\r\n        data.append('status_choices', item.status_choices);\r\n        data.append('sex_choices', item.sex_choices);\r\n        data.append('birth_place', item.birth_place);\r\n        data.append('relationship_choices', item.relationship_choices);\r\n        data.append('avatar', item.avatar, newFilename); // SHA256 encryption\r\n    \r\n        axios.post('/api/familytreepersons/', data, {\r\n          headers: {\r\n            'Content-Type': 'multipart/form-data',\r\n            Authorization: `JWT ${localStorage.getItem('token')}`\r\n          }\r\n        })\r\n        .then(() => this.refreshPersonList())\r\n        .then(() => ShowNotification(NOTIFY.ADD_PERSON, this.props.theme))\r\n        .catch(err => {\r\n          console.log(err);\r\n          ShowNotification(NOTIFY.ERROR, this.props.theme);\r\n        });\r\n      };\r\n\r\n      // handles new Relationship submission\r\n      handleSubmitRelationship = item => {\r\n        this.toggleRelationshipModal();\r\n        axios.post('/api/familytreerelationship/', item, {\r\n          headers: {\r\n            'Content-Type': 'application/json',\r\n            Accept : 'application/json',\r\n            Authorization: `JWT ${localStorage.getItem('token')}`\r\n          }\r\n        })\r\n          .then(() => this.refreshRelationshipList())\r\n          .then(() => ShowNotification(NOTIFY.ADD_RELATIONSHIP, this.props.theme))\r\n          .catch(err => {\r\n            console.log(err);\r\n            ShowNotification(NOTIFY.ERROR, this.props.theme);\r\n          });\r\n      };\r\n      \r\n      // prepares activePersonData for new Person\r\n      createPerson = () => {\r\n        this.setState({ activePersonData: {\r\n          user_id: localStorage.getItem('user_id'), \r\n          first_name: \"\", \r\n          last_name: \"\", \r\n          birth_date: \"\", \r\n          status_choices: 'living', \r\n          sex_choices: 'male', \r\n          birth_place: \"\", \r\n          avatar: undefined,\r\n        }, modal: !this.state.modal });\r\n      };\r\n\r\n      // gets the CSS Transform values for HTML element & its parent\r\n      getCSSTransformValues(personHTML){\r\n        // get parent coords (because of Draggable)\r\n        var personParentCoords = personHTML.parentElement.style.transform; // get CSS Transform as string\r\n        var personParentX = parseFloat(personParentCoords.slice(10, personParentCoords.indexOf(\"px\"))) // value between '(' and 'px'\r\n        var personParentY = personParentCoords.slice(personParentCoords.indexOf(\"px\") + 4, personParentCoords.length) // string between 'px, ' and EOF\r\n        personParentY = parseFloat(personParentY.slice(0, personParentY.indexOf(\"px\"))) // value between 'px, ' and 'px)'\r\n\r\n        // same as above, but for HTML element (because of Draggable)\r\n        var personTransformCoords = personHTML.style.transform;\r\n        var personTransformX = parseFloat(personTransformCoords.slice(10, personTransformCoords.indexOf(\"px\")))\r\n        var personTransformY = personTransformCoords.slice(personTransformCoords.indexOf(\"px\") + 4, personTransformCoords.length)\r\n        personTransformY = parseFloat(personTransformY.slice(0, personTransformY.indexOf(\"px\")))\r\n\r\n        return {parent: {x: personParentX, y: personParentY}, person: {x: personTransformX, y: personTransformY}};\r\n      }\r\n\r\n      // gets coords for every Person element\r\n      getCoordinates(){\r\n        var personList = [...this.state.personList]\r\n        var personListCoords = [...this.state.personCoordinates]\r\n        var personListHTML = Array.from(document.querySelectorAll(\"div.person\")); // all HTML element of DIV type, w/ 'person' in className\r\n        var personCoords = [];\r\n\r\n        personList.map(person => { // for every person in personList\r\n          try{\r\n            var personHTML = document.getElementById(personListHTML.find(el => parseInt(el.id) === person.id).classList[1].split(\"_\").pop()); // get HTML Element\r\n            personCoords = personHTML.getBoundingClientRect(); // get rectangle of the previously mentioned HTML ELement\r\n\r\n            var transform = this.getCSSTransformValues(personHTML); // use function which gets the CSS values for transform of HTML element & its parent\r\n\r\n            var index = personListCoords.findIndex(el => el.id === person.id); // find index of specific person in personListCoords (state personClassCoordinates) array\r\n            // calculate new coordinates, if function resetCoords has been called at least once, then it uses the 'previous parent transform' values\r\n            var x = person.x * this.state.windowSize.width + transform.parent.x - (!isNaN(transform.person.x) ? (person.x * this.state.windowSize.width - transform.person.x) : 0);\r\n            var y = person.y * this.state.windowSize.height + transform.parent.y - (!isNaN(transform.person.y) ? (person.y * this.state.windowSize.height - transform.person.y) : 0);\r\n            \r\n            \r\n            if(index !== -1){ // if this person already exists in an array which contains coordinates of persons\r\n              personListCoords[index].screen = {x: x, y: y}; // then overwrite coords with the newest ones\r\n            }\r\n            else{ // if not...\r\n              personListCoords.push({id: person.id, screen: {x: x, y: y}}); // add this person with its coordinates to the array\r\n              personHTML.style.transform = \"translate(\" + (x - personHTML.offsetLeft + 5) + \"px, \" + (y - personHTML.offsetTop + 5) + \"px)\" // move HTML element to the coords\r\n            }\r\n          }\r\n          catch(TypeError){\r\n            return\r\n          }\r\n        })\r\n        this.setState({\r\n          personCoordinates: personListCoords,\r\n          personSize: {width: personCoords.width, height: personCoords.height}\r\n        }, () => this.renderRelationships());\r\n      }\r\n\r\n      // resets the Person's coords to the initial (the ones from API)\r\n      resetCoords(){\r\n        var personList = [...this.state.personList]\r\n        var personListCoords = [...this.state.personCoordinates]\r\n        var personListHTML = Array.from(document.querySelectorAll(\"div.person\")); // all HTML element of DIV type, w/ 'person' in className\r\n\r\n        personList.map(person => { // for every person in personList\r\n          var personHTML = document.getElementById(personListHTML.find(el => parseInt(el.id) === person.id).classList[1].split(\"_\").pop()); // get HTML Element\r\n\r\n          var transform = this.getCSSTransformValues(personHTML); // use function which gets the CSS values for transform of HTML element & its parent\r\n\r\n          var index = personListCoords.findIndex(el => el.id === person.id); // find index of specific person in personListCoords (state personClassCoordinates) array\r\n          // set the values to the initial ones (ratio donwloaded from API * actual window size)\r\n          var x = person.x * this.state.windowSize.width;\r\n          var y = person.y * this.state.windowSize.height;\r\n\r\n          var oldPersonParent = {x: x - transform.person.x, y: y - transform.person.y} // calculate old parent CSS transform\r\n          var needToMove = {x: transform.parent.x - oldPersonParent.x, y: transform.parent.y - oldPersonParent.y} // calculate distance it needs to move, by using actual & old parent CSS transform values\r\n\r\n          personHTML.style.transform = \"translate(\" + (transform.person.x - needToMove.x) + \"px, \" + (transform.person.y - needToMove.y) + \"px)\" // move HTML element to the previously calculated forms\r\n\r\n          personListCoords[index].screen = {x: x, y: y}; // overwrite coords with the initial ones\r\n        })\r\n        this.setState({\r\n          personClassCoordinates: personListCoords,\r\n        }, () => {\r\n          this.renderRelationships();\r\n          ShowNotification(NOTIFY.RESET, this.props.theme);\r\n        });\r\n      }\r\n      \r\n      // saves new Person's coords to the API\r\n      saveCoords(){\r\n        this.toggleConfirmModal();\r\n        ShowNotification(NOTIFY.SAVING, this.props.theme)\r\n        var saved = true;\r\n        var personListCoords = [...this.state.personCoordinates]\r\n        var personList = [...this.state.personList]\r\n\r\n        personListCoords.map(item => {\r\n          var coords = {x: item.screen.x / this.state.windowSize.width, y: item.screen.y / this.state.windowSize.height}; // calculates new coords\r\n\r\n          if(personList.findIndex(el => el.id === item.id) !== -1){\r\n            let formData = new FormData();\r\n            formData.append('x', coords.x);\r\n            formData.append('y', coords.y);\r\n            axios\r\n            .patch(`/api/familytreepersons/${item.id}/`, formData, {\r\n              headers: {\r\n                'Content-Type': 'multipart/form-data',\r\n                Authorization: `JWT ${localStorage.getItem('token')}`\r\n              }\r\n            })\r\n              .catch(err => {\r\n                console.log(err);\r\n                saved = false;\r\n                ShowNotification(NOTIFY.ERROR, this.props.theme);\r\n              })\r\n          }          \r\n        })\r\n        setTimeout(() => {\r\n          this.setState({saving: false});\r\n          if (saved) { ShowNotification(NOTIFY.SAVE_COORDS, this.props.theme) };\r\n        }, 5000);\r\n      }\r\n\r\n      // sets the Person to be active, if double-clicked\r\n      setActivePerson(id) {\r\n        var array = [...this.state.activePersonIDList];\r\n\r\n          if(array.includes(id)){ // if it is active, then make it inactive\r\n            var index = array.indexOf(id);\r\n            array.splice(index, 1);\r\n          }\r\n          else{ // if it's not active, then make it active\r\n            array.push(id);\r\n          }\r\n          if(array.length > 2) // if we have more than 2 active elements, delete the first one (should be unnecessary)\r\n              array.splice(0, 1);\r\n\r\n          if(array.length === 2){ // if we already got 2 active elements, then toggle New Relationship modal\r\n            this.setState({activePersonIDList: array}, () => {\r\n              this.toggleRelationshipModal();\r\n              this.setState({activePersonIDList: []});\r\n            });\r\n          }\r\n          this.setState({activePersonIDList: array});\r\n      }\r\n\r\n      // delete whole familytree; since relationships are connected w/ persons, we don't need to delete any relationship. Just persons.\r\n      deleteEverything(){\r\n        this.toggleConfirmModal();\r\n        axios\r\n          .get(\"/api/familytreepersons/\", {\r\n            headers: { Authorization: `JWT ${localStorage.getItem('token')}`}\r\n          })\r\n          .then(res => {\r\n            res.data.map(item => {\r\n              axios\r\n              .delete(`/api/familytreepersons/${item.id}`, {\r\n                headers: { Authorization: `JWT ${localStorage.getItem('token')}`}\r\n              })\r\n              .then(() => {\r\n                this.refreshPersonList();\r\n                this.refreshRelationshipList();\r\n              })\r\n            })\r\n          })\r\n          .then(() => {\r\n            ShowNotification(NOTIFY.DELETE, this.props.theme);\r\n          })\r\n          .catch(err => {\r\n            console.log(err);\r\n            ShowNotification(NOTIFY.ERROR, this.props.theme);\r\n          });\r\n      }\r\n\r\n      // render persons by using Person component\r\n      renderItems = () => {\r\n        const newItems = this.state.personList;\r\n        return newItems.map(item => (\r\n          <Person \r\n            key={item.id}\r\n            person={item}\r\n            activePersons={this.state.activePersonIDList}\r\n            printable={this.state.printable}\r\n            refresh={this.refreshPersonList.bind(this)}\r\n            setActivePerson={this.setActivePerson.bind(this)}\r\n            getCoordinates={this.getCoordinates.bind(this)}\r\n            renderRelationships={this.renderRelationships.bind(this)}\r\n            refreshRelationships={this.refreshRelationshipList.bind(this)}\r\n            toggleConfirmModal={this.toggleConfirmModal.bind(this)}\r\n            theme={this.props.theme}\r\n          />\r\n        ));\r\n      };\r\n\r\n      // render Relationships by using Relationship component\r\n      renderRelationships = () => {\r\n        var relationshipList = [...this.state.relationshipList];\r\n        var coordinates = [...this.state.personCoordinates];\r\n        var personSize = this.state.personSize;\r\n        var pairs = [];\r\n        \r\n        // date - if older, then lower. i.e. 2019-01-01 < 2019-12-31 means true, 2019-12-31 < 2019-01-01 means false\r\n        relationshipList.map(item => {\r\n          var exists = false\r\n          if(pairs.length){\r\n            for(var i = 0; i < pairs.length; i++){\r\n              if((item.id_1 === pairs[i].id_1 || item.id_1 === pairs[i].id_2) && (item.id_2 === pairs[i].id_2 || item.id_2 === pairs[i].id_1)){\r\n                // draw only the newest one of certain pair\r\n                if(\r\n                  (pairs[i].end_date === null && item.end_date === null && pairs[i].begin_date < item.begin_date) \r\n                  || \r\n                  (pairs[i].end_date !== null && item.end_date === null)\r\n                  ||\r\n                  (pairs[i].end_date !== null && item.end_date != null && pairs[i].end_date < item.end_date)\r\n                ){ pairs[i] = item }\r\n                exists = true;\r\n                break;\r\n              }\r\n            }\r\n          }\r\n          if(!exists){ pairs.push(item); }\r\n        })\r\n\r\n        this.setState({\r\n          relationships: (pairs.map(item => (\r\n            <Relationship\r\n              key={\"relationship_\" + item.id + Date.now()} // it forces our app to re-render relationships whenever person is dragged\r\n              relationship={item}\r\n              personCoordinates={coordinates}\r\n              personSize={personSize}\r\n            />\r\n            )\r\n          )\r\n        )});\r\n      }\r\n\r\n      downloadPDF = () =>{\r\n        this.setState({\r\n          printable: true,\r\n        }, () => {\r\n          var css = '@page { size: 20in 9in; margin: 0;}',\r\n          head = document.head || document.getElementsByTagName('head')[0],\r\n          style = document.createElement('style');\r\n\r\n          style.type = 'text/css';\r\n          style.media = 'print';\r\n\r\n          if (style.styleSheet){\r\n            style.styleSheet.cssText = css;\r\n          } else {\r\n            style.appendChild(document.createTextNode(css));\r\n          }\r\n\r\n          head.appendChild(style);\r\n\r\n          window.print();\r\n\r\n          this.setState({\r\n            printable: false,\r\n          })\r\n        })\r\n      }\r\n\r\n      // renders whole Familytree page, which is visible after log-in (content + buttons, no nav bar)\r\n      render() {\r\n        return (\r\n          <React.Fragment>\r\n            <div className=\"contentPerson\">\r\n              <svg className={'relationshipContainer-' + this.props.theme} height={this.state.windowSize.height} width={this.state.windowSize.width}>\r\n                {this.state.relationships}\r\n              </svg>\r\n              {this.renderItems()}     \r\n              {this.state.ModalFirstTime ? (\r\n                <ModalFirstTime\r\n                  toggle={this.toggleFirstTimeModal}\r\n                  onSave={this.toggleFirstTimeModal}\r\n                  theme={this.props.theme}\r\n                />\r\n              ) : null}\r\n              {this.state.modal ? (\r\n                <ModalPerson\r\n                 activeItem={this.state.activePersonData}\r\n                 toggle={this.togglePersonModal}\r\n                 onSave={this.handleSubmitPerson}\r\n                 theme={this.props.theme}\r\n                />\r\n              ) : null}\r\n              {this.state.ModalRelationship ? (\r\n                <ModalRelationship\r\n                  activeItem={this.state.activeRelationshipData}\r\n                  toggle={this.toggleRelationshipModal}\r\n                  onSave={this.handleSubmitRelationship}\r\n                  theme={this.props.theme}\r\n                />\r\n              ) : null}\r\n              {this.state.ModalConfirm ? (\r\n                <ModalConfirm \r\n                  header={this.state.activeConfirmData.header}\r\n                  content={this.state.activeConfirmData.content}\r\n                  confirmText={this.state.activeConfirmData.confirmText}\r\n                  cancelText={this.state.activeConfirmData.cancelText}\r\n                  toggle={this.toggleConfirmModal}\r\n                  onConfirm={this.state.activeConfirmData.onConfirm}\r\n                  theme={this.props.theme}\r\n                />\r\n              ) : null}\r\n            </div>\r\n            {this.state.printable ? null :(\r\n            <div className=\"buttons\">\r\n              <div className=\"download-buttons\">\r\n                <button onClick={() => this.downloadPDF()} className={\"btn \" + (this.props.theme === 'dark' ? 'dark btn-outline-' : 'light btn-') + \"primary btn-circle btn-xl famtree\"}>\r\n                  <i className=\"fas fa-download\"></i>\r\n                </button>\r\n              </div>\r\n              <div className={\"operating-buttons \" + this.props.theme} id=\"operating-buttons\">\r\n                <button className=\"floating-btn\" onClick={() => document.getElementById('operating-buttons').classList.toggle('active')}>\r\n                  <i className=\"fa fa-bars\"></i>\r\n                </button>\r\n\r\n                <menu className=\"items-wrapper\">\r\n                  <button className=\"menu-item fas fa-plus\" onClick={this.createPerson}></button>\r\n                  <button href=\"#\" className=\"menu-item far fa-save\" onClick={() => this.toggleConfirmModal(\"Save coords\", \"Are you sure you want to save coords for every person in Familytree?\", \"Save\", \"Cancel\", () => this.saveCoords())}></button>\r\n                  <button href=\"#\" className=\"menu-item fas fa-redo\" onClick={this.resetCoords.bind(this)}></button>\r\n                  <button href=\"#\" className=\"menu-item fas fa-times\" onClick={() => this.toggleConfirmModal(\"Delete Familytree\", \"Are you sure you want to delete WHOLE familytree?\", \"Delete\", \"Cancel\", () => this.deleteEverything())}></button>\r\n                  </menu>\r\n              </div>\r\n            </div>\r\n            )}\r\n          </React.Fragment>\r\n        );\r\n      }\r\n    }\r\n    export default Familytree;","// frontend/src/App.js\r\n/*eslint array-callback-return: 0*/\r\n\r\n    import React, { Component } from \"react\";\r\n    import './App.css';\r\n    import './Mobile.css';\r\n    import './components/loading/Loading.css'\r\n    import Nav from './components/nav/Nav';\r\n    import LoginForm from './components/auth/LoginForm';\r\n    import SignupForm from './components/auth/SignupForm';\r\n    import Familytree from \"./Familytree\";\r\n    import axios from \"axios\";\r\n    import FadeIn from \"react-fade-in\";\r\n    import Lottie from \"react-lottie\";\r\n    import * as stillLoadingData from \"./components/loading/stillloading.json\";\r\n    import * as doneLoadingData from \"./components/loading/doneloading.json\";\r\n    import { ToastContainer, toast} from 'react-toastify';\r\n    import {NOTIFY} from './components/Enums.ts';\r\n    import ShowNotification from './components/notification/Notification';\r\n\r\n    \r\n    // options for animation, when API is loading\r\n    const defaultOptionsLoading = {\r\n        loop: true,\r\n        autoplay: true,\r\n        animationData: stillLoadingData.default,\r\n        rendererSettings: {\r\n          preserveAspectRatio: \"xMidYMid meet\"\r\n        }\r\n      }\r\n\r\n    // options for animation, when API has been loaded\r\n    const defaultOptionsLoaded = {\r\n        loop: false,\r\n        autoplay: true,\r\n        animationData: doneLoadingData.default,\r\n        rendererSettings: {\r\n          preserveAspectRatio: \"xMidYMid meet\"\r\n        }\r\n      };\r\n\r\n    class App extends Component {\r\n      constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n          loadingPersonList: undefined, // flag, if it's still loading personList\r\n          donePersonList: undefined, // flag, if it already loaded personList\r\n          personList: [], // list of persons\r\n\r\n          loadingRelationshipList: undefined, // flag, if it's still loading relationshipList\r\n          doneRelationshipList: undefined, // flag, if it already loaded relationshipList\r\n          relationshipList: [], // list of relationships\r\n          \r\n          displayed_form: localStorage.getItem('token') ? '' : 'login', // form to display\r\n          theme: localStorage.getItem('theme') ?? 'dark',\r\n\r\n          logged_in: localStorage.getItem('token') ? true : false, // flag, if user is already logged in\r\n          username: '',\r\n        };\r\n      }\r\n\r\n      loginCounter = 0; // it makes sure noone will log into 2 different accounts from one browser (probably simple flag should be enough)\r\n\r\n      componentDidMount() {\r\n        if(!localStorage.getItem('theme')){ localStorage.setItem('theme', 'dark'); }\r\n        \r\n        var body = document.body;\r\n        body.classList.add(localStorage.getItem('theme'));\r\n\r\n        const cssStyles = [\r\n          ['--main-primary-dark', '#FFAD00'],\r\n          ['--main-primary-hover-dark', '#B97E00'],\r\n          ['--main-secondary-dark', '#63FFF9'],\r\n          ['--main-secondary-hover-dark', '#00F7F7'],\r\n\r\n          ['--main-primary-light', '#005200'],\r\n          ['--main-primary-hover-light', '#29811F'],\r\n          ['--main-secondary-light', '#723C47'],\r\n          ['--main-secondary-hover-light', '#834852'],\r\n        ];\r\n\r\n        cssStyles.map(item => {\r\n          if(!localStorage.getItem(item[0])){ localStorage.setItem(item[0], item[1]); }\r\n          document.documentElement.style.setProperty(item[0], localStorage.getItem(item[0]))\r\n        })\r\n\r\n        if (this.state.logged_in) { // if person is logged in, dont force user to relog\r\n          axios\r\n            .get('/current_user/', {\r\n              headers: { Authorization: `JWT ${localStorage.getItem('token')}`},\r\n            })\r\n            .then(res => {\r\n              this.setState({ username: res.data.username }, () => ShowNotification(NOTIFY.SUCCESS_LOGIN, this.state.theme));\r\n            })\r\n            .catch(() => {\r\n              ShowNotification(NOTIFY.ERROR_TIMEOUT, this.state.theme)\r\n              this.handle_logout();\r\n            })\r\n          }\r\n      }\r\n\r\n      componentDidUpdate(){\r\n        if (this.loginCounter < 1 && this.state.logged_in && !this.state.doneRelationshipList && !this.state.donePersonList){\r\n          this.loginCounter += 1;\r\n          \r\n          this.fetchPersonList();\r\n          this.fetchRelationshipList();\r\n        }\r\n      }\r\n\r\n      // get list of Persons from API, while loading page\r\n      fetchPersonList = () => {\r\n        setTimeout(() => {\r\n          axios\r\n            .get(\"/api/familytreepersons/\", {\r\n              headers: { Authorization: `JWT ${localStorage.getItem('token')}`}\r\n            })\r\n            .then(res => this.setState({ personList: res.data }))\r\n            .then(() => {\r\n                this.setState({ loadingPersonList: true });\r\n                setTimeout(() => {\r\n                  this.setState({ donePersonList: true });\r\n              }, 1000); // miliseconds AFTER Person List loading is done (1s)\r\n            });\r\n        }, 1800); // miliseconds AFTER Person List loading should be called (1.8s)\r\n      }\r\n\r\n      // get list of Relationships from API, while loading page\r\n      fetchRelationshipList = () => {\r\n        setTimeout(() => {\r\n        axios\r\n          .get(\"/api/familytreerelationship/\", {\r\n            headers: { Authorization: `JWT ${localStorage.getItem('token')}`}\r\n          })\r\n          .then(res => this.setState({ relationshipList: res.data }))\r\n          .then(() => {\r\n            this.setState({ loadingRelationshipList: true });\r\n            setTimeout(() => {\r\n                this.setState({ doneRelationshipList: true });   \r\n            }, 1000); // miliseconds AFTER Relationship List loading is done (1s)\r\n          });\r\n        }, 1000); // miliseconds AFTER Person List loading should be called (1s)\r\n      }\r\n\r\n      // check in API, if provided credentials are correct\r\n      handle_login = (e, data) => {\r\n        e.preventDefault();\r\n        axios.post('/token-auth/', data, {\r\n          headers: {\r\n            'Content-Type': 'application/json'\r\n          }\r\n        })\r\n          .then(res => {\r\n            localStorage.setItem('token', res.data.token); // store user's login token\r\n            localStorage.setItem('user_id', res.data.user.id); // store user's id\r\n            localStorage.setItem('date_joined', res.data.user.date_joined) // store user's registration date\r\n\r\n            this.setState({\r\n              logged_in: true,\r\n              displayed_form: '', // familytree page\r\n              username: res.data.user.username,\r\n            }, () => ShowNotification(NOTIFY.SUCCESS_LOGIN, this.state.theme));\r\n          })\r\n          .catch(() => ShowNotification(NOTIFY.ERROR_LOGIN, this.state.theme));\r\n      };\r\n    \r\n      // register user to website; throws error when username already exists\r\n      handle_signup = (e, data) => {\r\n        e.preventDefault();\r\n\r\n        var valid_password = /^(?=.*\\d)(?=.*[A-Z])(?=.*[a-z])(?=.*[^\\w\\d\\s:])([^\\s]){8,16}$/.test(data.password)\r\n        if(!valid_password){\r\n          ShowNotification(NOTIFY.SNEAKY_PASSWORD, this.state.theme);\r\n          return;\r\n        }\r\n        \r\n        axios.post('/users/', data, {\r\n          headers: {\r\n            'Content-Type': 'application/json'\r\n          }\r\n        })\r\n          .then(res => {\r\n            this.setState({\r\n              logged_in: false,\r\n              displayed_form: 'login', // redirect to login page\r\n              username: res.data.username\r\n            }, () => ShowNotification(NOTIFY.SUCCESS_REGISTER, this.state.theme));\r\n          })\r\n          .catch(() => ShowNotification(NOTIFY.ERROR_REGISTER, this.state.theme));\r\n      };\r\n    \r\n      // log out user from website\r\n      handle_logout = () => {\r\n        localStorage.removeItem('token'); // remove token from local storage\r\n        localStorage.removeItem('user_id'); // remove user's id from local storage\r\n        localStorage.removeItem('date_joined'); // remove registration date from local storage\r\n        this.loginCounter = 0; // let website know that no one is logged in by using this browser\r\n        this.setState({ // reset all variables\r\n          logged_in: false, \r\n          username: '',\r\n          personList: [],\r\n          relationshipList: [],\r\n          relationships: [],\r\n          loadingPersonList: undefined,\r\n          donePersonList: undefined,\r\n          displayed_form: 'login', // redirect to login page\r\n          loadingRelationshipList: undefined,\r\n          doneRelationshipList: undefined,\r\n        }, () => ShowNotification(NOTIFY.SUCCESS_LOGOUT, this.state.theme));\r\n      };\r\n    \r\n      // display specific form (login/signup)\r\n      display_form = form => {\r\n        this.setState({\r\n          displayed_form: form\r\n        });\r\n      };\r\n\r\n      changeThemeMode = () => {\r\n        var newTheme = this.state.theme === \"dark\" ? \"light\" : \"dark\"\r\n        var body = document.body;\r\n        body.classList.remove(localStorage.getItem('theme'));\r\n\r\n        localStorage.setItem('theme', newTheme)\r\n\r\n        var body = document.body;\r\n        body.classList.add(localStorage.getItem('theme'));\r\n        \r\n        this.setState({\r\n            theme: newTheme,\r\n          }, () => ShowNotification(NOTIFY.CHANGE_THEME, this.state.theme)\r\n        );\r\n      }\r\n      \r\n      // render page (nav bar + login/signup form if not logged in; else Familytree.js)\r\n      render() {\r\n        let form;\r\n        switch (this.state.displayed_form) {\r\n          case 'login':\r\n            form = <LoginForm handle_login={this.handle_login} theme={this.state.theme}/>;\r\n            break;\r\n          case 'signup':\r\n            form = <SignupForm handle_signup={this.handle_signup} theme={this.state.theme}/>;\r\n            break;\r\n          default:\r\n            form = null;\r\n        }\r\n        \r\n        return (\r\n          <div className={\"App-\"+this.state.theme}>\r\n            <Nav\r\n              logged_in={this.state.logged_in}\r\n              display_form={this.display_form}\r\n              handle_logout={this.handle_logout}\r\n              username={this.state.username}\r\n              theme={this.state.theme}\r\n              changeThemeMode={this.changeThemeMode}\r\n              />\r\n            \r\n            {form}\r\n            {this.state.logged_in ? (\r\n              !this.state.donePersonList || !this.state.doneRelationshipList ? (\r\n                <h3>\r\n                  <FadeIn>\r\n                    <div className={\"loading-\" + this.state.theme}>\r\n                      <div className={\"loadingPart-\" + this.state.theme}>\r\n                        <h4 className={\"loadingText-\" + this.state.theme}>Fetching Persons</h4>\r\n                        <div className={\"loadingAnimation-\" + this.state.theme}>\r\n                          {!this.state.loadingPersonList ? (\r\n                              <Lottie options={defaultOptionsLoading} height={100} width={200}/>\r\n                          ) : (\r\n                            <Lottie options={defaultOptionsLoaded} height={100} width={200}/>\r\n                          )}\r\n                        </div>\r\n                      </div>\r\n                      <div className={\"loadingPart-\" + this.state.theme}>\r\n                        <h4 className={\"loadingText-\" + this.state.theme}>Fetching Relationships</h4>\r\n                        <div className={\"loadingAnimation-\" + this.state.theme}>\r\n                          {!this.state.loadingRelationshipList ? (\r\n                            <Lottie options={defaultOptionsLoading} height={100} width={200}/>\r\n                          ) : (\r\n                            <Lottie options={defaultOptionsLoaded} height={100} width={200}/>\r\n                          )}\r\n                        </div>\r\n                      </div>\r\n                      \r\n                    </div>\r\n                  </FadeIn>\r\n                </h3>\r\n              ) : (\r\n                    <React.Fragment>\r\n                      <Familytree \r\n                        personList = {this.state.personList}\r\n                        relationshipList = {this.state.relationshipList}\r\n                        changeThemeMode = {this.changeThemeMode}\r\n                        theme = {this.state.theme}\r\n                      />\r\n                    </React.Fragment>\r\n                  )\r\n              ) : null\r\n            }\r\n              <ToastContainer position={toast.POSITION.TOP_LEFT}/>\r\n          </div>\r\n        );         \r\n      }\r\n    }\r\n    export default App;","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n"," // frontend/src/index.js\r\n\r\nimport React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport 'bootstrap/dist/css/bootstrap.min.css';\r\nimport App from './App';\r\nimport * as serviceWorker from './serviceWorker';\r\n\r\nReactDOM.render(<App />, document.getElementById('root'));\r\n// If you want your app to work offline and load faster, you can change\r\n// unregister() to register() below. Note this comes with some pitfalls.\r\n// Learn more about service workers: http://bit.ly/CRA-PWA\r\nserviceWorker.unregister();"],"sourceRoot":""}